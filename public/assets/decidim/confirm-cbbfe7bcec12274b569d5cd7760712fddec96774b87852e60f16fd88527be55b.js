"use strict";function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(n,e,o){return e&&t(n.prototype,e),o&&t(n,o),n}}();!function(t){var n=t.document,e=null,o=function(){function n(o){_classCallCheck(this,n),this.$modal=$(e),this.$source=o,this.$content=t.$(".confirm-modal-content",this.$modal),this.$buttonConfirm=t.$("[data-confirm-ok]",this.$modal),this.$buttonCancel=t.$("[data-confirm-cancel]",this.$modal);var i="confirm-modal-title-"+Math.random().toString(36).substring(7);this.$modal.removeAttr("id"),$("#confirm-modal-title",this.$modal).attr("id",i),this.$modal.attr("aria-labelledby",i),$("body").append(this.$modal),this.$modal.foundation()}return _createClass(n,[{key:"confirm",value:function(t){var n=this;return this.$content.html(t),this.$buttonConfirm.off("click"),this.$buttonCancel.off("click"),new Promise(function(t){n.$buttonConfirm.on("click",function(e){e.preventDefault(),n.$modal.foundation("close"),t(!0),n.$source.focus()}),n.$buttonCancel.on("click",function(e){e.preventDefault(),n.$modal.foundation("close"),t(!1),n.$source.focus()}),n.$modal.foundation("open").on("closed.zf.reveal",function(){n.$modal.remove()})})}}]),n}();t.Decidim=t.Decidim||{},t.Decidim.ConfirmDialog=o,n.addEventListener("rails:attachBindings",function(){var i=t.Rails,r=i.fire,c=i.matches,a=i.stopEverything,l=function(n,i){var c=t.$(i).data("confirm");return!c||!!r(i,"confirm")&&(null===e&&(e=t.$("#confirm-modal")[0].outerHTML,t.$("#confirm-modal").remove()),new o(t.$(i)).confirm(c).then(function(e){var o=r(i,"confirm:complete",[e]);if(e&&o)if(t.$(i).data("confirm",null),t.$(i).removeAttr("data-confirm"),"click"===n.type&&(t.$(i).is('button[type="submit"]')||t.$(i).is('input[type="submit"]')))t.$(i).parents("form").submit();else{var c=n.originalEvent||n,a=c;"function"==typeof Event&&(a=new c.constructor(c.type,c)),n.target.dispatchEvent(a)}}),!1)},u=function(t,n){l(t,n)||a(t)},f=function(t,n){for(var e=t.target;e instanceof Element&&!c(e,n);)e=e.parentNode;return e instanceof Element?e:null},s=function(t,n){return n.some(function(n){var e=f(t,n);return null!==e&&(u(t,e),!0)})};n.addEventListener("click",function(t){return s(t,[i.linkClickSelector,i.buttonClickSelector,i.formInputClickSelector])}),n.addEventListener("change",function(t){return s(t,[i.inputChangeSelector])}),n.addEventListener("submit",function(t){return s(t,[i.formSubmitSelector])}),n.addEventListener("DOMContentLoaded",function(){t.$(i.formInputClickSelector).on("click.confirm",function(t){u(t,f(t,i.formInputClickSelector))})})})}(window);