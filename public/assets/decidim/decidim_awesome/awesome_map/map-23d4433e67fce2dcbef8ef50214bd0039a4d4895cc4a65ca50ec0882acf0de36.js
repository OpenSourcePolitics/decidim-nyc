/*!
 Leaflet.FeatureGroup.SubGroup 1.0.2+00bb0d4
 (c) 2015-2017 Boris Seang
 License BSD-2-Clause
 */
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){"function"==typeof define&&define.amd?define(["leaflet"],t):t("object"==typeof module&&module.exports?require("leaflet"):e.L)}(this,function(e){e.FeatureGroup.SubGroup=e.FeatureGroup.extend({initialize:function(t,n){e.FeatureGroup.prototype.initialize.call(this,n),this.setParentGroup(t)},setParentGroup:function(t){var n=t instanceof e.LayerGroup;return this._parentGroup=t,this.onAdd=n?"function"==typeof t.addLayers?this._onAddToGroupBatch:this._onAddToGroup:this._onAddToMap,this.onRemove=n?"function"==typeof t.removeLayers?this._onRemoveFromGroupBatch:this._onRemoveFromGroup:this._onRemoveFromMap,this.addLayer=n?this._addLayerToGroup:this._addLayerToMap,this.removeLayer=n?this._removeLayerFromGroup:this._removeLayerFromMap,this},setParentGroupSafe:function(e){var t=this._map;return t&&t.removeLayer(this),this.setParentGroup(e),t&&t.addLayer(this),this},getParentGroup:function(){return this._parentGroup},_onAddToGroupBatch:function(e){var t=this.getLayers();this._map=e,this._parentGroup.addLayers(t)},_onRemoveFromGroupBatch:function(){var e=this.getLayers();this._parentGroup.removeLayers(e),this._map=null},_onAddToGroup:function(e){var t=this._parentGroup;this._map=e,this.eachLayer(t.addLayer,t)},_onRemoveFromGroup:function(){var e=this._parentGroup;this.eachLayer(e.removeLayer,e),this._map=null},_onAddToMap:e.FeatureGroup.prototype.onAdd,_onRemoveFromMap:e.FeatureGroup.prototype.onRemove,_addLayerToGroup:function(e){if(this.hasLayer(e))return this;e.addEventParent(this);var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._parentGroup.addLayer(e),this.fire("layeradd",{layer:e})},_removeLayerFromGroup:function(e){if(!this.hasLayer(e))return this;var t=e in this._layers?e:this.getLayerId(e);return(e=this._layers[t]).removeEventParent(this),this._map&&e&&this._parentGroup.removeLayer(e),delete this._layers[t],this.fire("layerremove",{layer:e})},_addLayerToMap:e.FeatureGroup.prototype.addLayer,_removeLayerFromMap:e.FeatureGroup.prototype.removeLayer}),e.featureGroup.subGroup=function(t,n){return new e.FeatureGroup.SubGroup(t,n)}}),function(e){var t=/(\s*\S+|\s)$/,n=/^(\S*)/;e.truncate=function(t,n){return e("<div></div>").append(t).truncate(n).html()},e.fn.truncate=function(r){e.isNumeric(r)&&(r={length:r});var a=e.extend({},e.truncate.defaults,r);return this.each(function(){var r=e(this);a.noBreaks&&r.find("br").replaceWith(" ");var o=r.text(),s=o.length-a.length;if(a.stripTags&&r.text(o),a.words&&s>0){var i=o.slice(0,a.length).replace(t,"").length;s=a.keepFirstWord&&0===i?o.length-n.exec(o)[0].length-1:o.length-i-1}s<0||!s&&!a.truncated||e.each(r.contents().get().reverse(),function(t,n){var r=e(n),o=r.text().length;return o<=s?(a.truncated=!0,s-=o,void r.remove()):3===n.nodeType?(a.finishBlock?e(n.splitText(o)).replaceWith(a.ellipsis):e(n.splitText(o-s-1)).replaceWith(a.ellipsis),!1):(r.truncate(e.extend(a,{length:o-s})),!1)})})},e.truncate.defaults={stripTags:!1,words:!1,keepFirstWord:!1,noBreaks:!1,finishBlock:!1,length:Infinity,ellipsis:"\u2026"}}(jQuery),function(e){var t=e.$,n=function(e){if(e){var t=e.split(",");if(t.length>=2){var n=parseFloat(t[0]),r=parseFloat(t[1]);if(n&&r)return[n,r]}}return null},r=function(){return{length:t("#awesome-map").data("truncate")||255,center:n(t("#awesome-map").data("map-center")),zoom:t("#awesome-map").data("map-zoom"),menu:{amendments:t("#awesome-map").data("menu-amendments"),meetings:t("#awesome-map").data("menu-meetings"),hashtags:t("#awesome-map").data("menu-hashtags")}}},a=function(e){return t.truncate(e,r())},o=function(){return{withdrawn:t("#awesome-map").data("show-withdrawn"),accepted:t("#awesome-map").data("show-accepted"),evaluating:t("#awesome-map").data("show-evaluating"),notAnswered:t("#awesome-map").data("show-not-answered"),rejected:t("#awesome-map").data("show-rejected")}},s=function(){return t("#awesome-map").data("hide-controls")},i=function(){return t("#awesome-map").data("collapsed")},l=function(){return t("#awesome-map").data("components")};e.AwesomeMap=e.AwesomeMap||{},e.AwesomeMap.truncate=a,e.AwesomeMap.options=r,e.AwesomeMap.show=o,e.AwesomeMap.collapsedMenu=i,e.AwesomeMap.hideControls=s,e.AwesomeMap.components=l}(window),function(e){var t=function(t){var n={color:getComputedStyle(document.documentElement).getPropertyValue("--primary"),children:function(){},parent:null,name:null};if(t){var r=function(){var n=t.id?parseInt(t.id,10):parseInt(t,10),r=e.AwesomeMap.categories.find(function(e){return e.id==n});if(r)return r.children=function(){return e.AwesomeMap.categories.filter(function(e){return e.parent===r.id})},{v:r}}();if("object"==typeof r)return r.v}return n};e.AwesomeMap=e.AwesomeMap||{},e.AwesomeMap.getCategory=t}(window),function(e){var t=[],n=function(e){var n=[];if(e){var r=e.match(/gid:\/\/[^\s<]+/g);r&&(n=r.filter(function(e){return-1!=e.indexOf("/Decidim::Hashtag/")}).map(function(e){var n=e.split("/"),r="_"==n[5].charAt(0),a=r?n[5].substr(1):n[5],o="#"+a,s='<a href="/search?term='+o+'">'+o+"</a>",i={color:getComputedStyle(document.documentElement).getPropertyValue("--secondary"),gid:e,id:parseInt(n[4],10),fromSelector:r,tag:a,name:o,html:s};return t.push(i),i}))}return n},r=function(e){return e.replace(/gid:\/\/[^\s<]+/g,"")},a=function(e,t){return t.forEach(function(t){e+=" "+t.html}),e};e.AwesomeMap=e.AwesomeMap||{},e.AwesomeMap.hashtags=t,e.AwesomeMap.collectHashtags=n,e.AwesomeMap.appendHtmlHashtags=a,e.AwesomeMap.removeHashtags=r}(window),function(e){var t=e.AwesomeMap,n=t.collapsedMenu,r=t.options,a=t.categories,o={},s=L.markerClusterGroup(),i=L.control.layers(null,null,{position:"topleft",sortLayers:!1,collapsed:n()}),l=function(e,t){o.proposals={label:'<span class="awesome_map-component" id="awesome_map-component_'+t.id+'" title="0">'+(t.name||window.DecidimAwesome.texts.proposals)+"</span>",group:L.featureGroup.subGroup(s)},i.addOverlay(o.proposals.group,o.proposals.label),o.proposals.group.addTo(e),r().menu.amendments&&t.amendments&&(o.amendments={label:'<span class="awesome_map-component" id="awesome_map-amendments_'+t.id+'" title="0">'+window.DecidimAwesome.texts.amendments+"</span>",group:L.featureGroup.subGroup(s)},i.addOverlay(o.amendments.group,o.amendments.label),o.amendments.group.addTo(e))},p=function(e,t){o.meetings={label:'<span class="awesome_map-component" id="awesome_map-component_'+t.id+'" title="0">'+(t.name||window.DecidimAwesome.texts.meetings)+"</span>",group:L.featureGroup.subGroup(s)},i.addOverlay(o.meetings.group,o.meetings.label),o.meetings.group.addTo(e)},c=function(){$(i.getContainer()).contents("form").after('<div id="awesome_map-categories-control" class="active"><b class="awesome_map-title-control">'+window.DecidimAwesome.texts.categories+'</b><div class="categories-container"></div></div>\n    <div id="awesome_map-hashtags-control"><b class="awesome_map-title-control">'+window.DecidimAwesome.texts.hashtags+'</b><div class="hashtags-container"></div><a href="#" class="awesome_map-toggle_all_tags">'+window.DecidimAwesome.texts.select_deselect_all+"</a></div>")},d=function(e){a&&a.length&&a.forEach(function(t){var n='<i class="awesome_map-category-'+t.id+'"></i> '+t.name;o[t.id]={label:n,group:L.featureGroup.subGroup(s)},o[t.id].group.addTo(e),setTimeout(function(){$("#awesome_map-categories-control .categories-container").append('<label data-layer="'+t.id+'" class="awesome_map-category-'+t.id+(t.parent?" subcategory":"")+'"><input type="checkbox" class="awesome_map-categories-selector" checked><span>'+n+"</span></label>")})})},u=function(t,n,r){n&&n.length&&($("#awesome_map-hashtags-control").show(),n.forEach(function(n){o[n.tag]||(o[n.tag]={label:n.name,group:L.featureGroup.subGroup(s)},o[n.tag].group.addTo(t),$("#awesome_map-hashtags-control .hashtags-container").append('<label data-layer="'+n.tag+'" class="awesome_map-hashtag-'+n.tag+'"><input type="checkbox" class="awesome_map-hashtags-selector" checked><span>'+n.name+"</span></label>"),e.AwesomeMap.hashtagAdded(n,$("#awesome_map-hashtags-control .hashtags-container"))),r.addTo(o[n.tag].group);var a=$("label.awesome_map-hashtag-"+n.tag);a.attr("title",parseInt(a.attr("title")||0)+1+" "+window.DecidimAwesome.texts.items)}))};e.AwesomeMap.layers=o,e.AwesomeMap.control=i,e.AwesomeMap.cluster=s,e.AwesomeMap.addProposalsControls=l,e.AwesomeMap.addMeetingsControls=p,e.AwesomeMap.addSearchControls=c,e.AwesomeMap.addCategoriesControls=d,e.AwesomeMap.addHashtagsControls=u,e.AwesomeMap.hashtagAdded=$.noop}(window),function(e,t){var n=t.jQuery;"object"==typeof exports?module.exports=n?e(t,n):function(n){if(n&&!n.fn)throw"Provide jQuery or null";return e(t,n)}:"function"==typeof define&&define.amd?define(function(){return e(t)}):e(t,!1)}(function(e,t){"use strict";function n(e,t){return function(){var n,r=this,a=r.base;return r.base=e,n=t.apply(r,arguments),r.base=a,n}}function r(e,t){return ie(t)&&((t=n(e?e._d?e:n(s,e):s,t))._d=(e&&e._d||0)+1),t}function a(e,t){var n,a=t.props;for(n in a)!$e.test(n)||e[n]&&e[n].fix||(e[n]="convert"!==n?r(e.constructor.prototype[n],a[n]):a[n])}function o(e){return e}function s(){return""}function i(e){try{throw console.log("JsRender dbg breakpoint: "+e),"dbg breakpoint"}catch(t){}return this.base?this.baseApply(arguments):e}function l(e){this.name=(t.link?"JsViews":"JsRender")+" Error",this.message=e||this.name}function p(e,t){if(e){for(var n in t)e[n]=t[n];return e}}function c(e,t,n){return e?le(e)?c.apply(oe,e):(be=n?n[0]:be,/^(\W|_){5}$/.test(e+t+be)||R("Invalid delimiters"),ve=e[0],we=e[1],_e=t[0],ye=t[1],fe.delimiters=[ve+we,_e+ye,be],e="\\"+ve+"(\\"+be+")?\\"+we,t="\\"+_e+"\\"+ye,re="(?:(\\w+(?=[\\/\\s\\"+_e+"]))|(\\w+)?(:)|(>)|(\\*))\\s*((?:[^\\"+_e+"]|\\"+_e+"(?!\\"+ye+"))*?)",me.rTag="(?:"+re+")",re=new RegExp("(?:"+e+re+"(\\/)?|\\"+ve+"(\\"+be+")?\\"+we+"(?:(?:\\/(\\w+))\\s*|!--[\\s\\S]*?--))"+t,"g"),me.rTmpl=new RegExp("^\\s|\\s$|<.*>|([^\\\\]|^)[{}]|"+e+".*"+t),he):fe.delimiters}function d(e,t){t||!0===e||(t=e,e=void 0);var n,r,a,o,s=this,i="root"===t;if(e){if(!(o=t&&s.type===t&&s))if(n=s.views,s._.useKey){for(r in n)if(o=t?n[r].get(e,t):n[r])break}else for(r=0,a=n.length;!o&&r<a;r++)o=t?n[r].get(e,t):n[r]}else if(i)o=s.root;else if(t)for(;s&&!o;)o=s.type===t?s:void 0,s=s.parent;else o=s.parent;return o||void 0}function u(){var e=this.get("item");return e?e.index:void 0}function m(){return this.index}function f(e,t,n,r){var a,o,i,l=0;if(1===n&&(r=1,n=void 0),t)for(i=(o=t.split(".")).length;e&&l<i;l++)a=e,e=o[l]?e[o[l]]:e;return n&&(n.lt=n.lt||l<i),void 0===e?r?s:"":r?function(){return e.apply(a,arguments)}:e}function g(n,r,a){var o,s,i,l,c,d,u,m=this,f=!Ae&&arguments.length>1,g=m.ctx;if(n){if(m._||(c=m.index,m=m.tag),d=m,g&&g.hasOwnProperty(n)||(g=de).hasOwnProperty(n)){if(i=g[n],"tag"===n||"tagCtx"===n||"root"===n||"parentTags"===n)return i}else g=void 0;if((!Ae&&m.tagCtx||m.linked)&&(i&&i._cxp||(m=m.tagCtx||ie(i)?m:!(m=m.scope||m).isTop&&m.ctx.tag||m,void 0!==i&&m.tagCtx&&(m=m.tagCtx.view.scope),g=m._ocps,(i=g&&g.hasOwnProperty(n)&&g[n]||i)&&i._cxp||!a&&!f||((g||(m._ocps=m._ocps||{}))[n]=i=[{_ocp:i,_vw:d,_key:n}],i._cxp={path:Me,ind:0,updateValue:function(e){return t.observable(i[0]).setProperty(Me,e),this}})),l=i&&i._cxp)){if(arguments.length>2)return(s=i[1]?me._ceo(i[1].deps):[Me]).unshift(i[0]),s._cxp=l,s;if(c=l.tagElse,u=i[1]?l.tag&&l.tag.cvtArgs?l.tag.cvtArgs(c,1)[l.ind]:i[1](i[0].data,i[0],me):i[0]._ocp,f)return me._ucp(n,r,m,l),m;i=u}return i&&ie(i)&&p(o=function(){return i.apply(this&&this!==e?this:d,arguments)},i),o||i}}function h(e){return e&&(e.fn?e:this.getRsc("templates",e)||pe(e))}function v(e,t,n,r){var o,s,i,l,c,d="number"==typeof n&&t.tmpl.bnds[n-1];if(void 0===r&&d&&d._lr&&(r=""),void 0!==r?n=r={props:{},args:[r]}:d&&(n=d(t.data,t,me)),d=d._bd&&d,e||d){if(o=(s=t._lc)&&s.tag,n.view=t,!o){if(o=p(new me._tg,{_:{bnd:d,unlinked:!0,lt:n.lt},inline:!s,tagName:":",convert:e,onArrayChange:!0,flow:!0,tagCtx:n,tagCtxs:[n],_is:"tag"}),(l=n.args.length)>1)for(c=o.bindTo=[];l--;)c.unshift(l);s&&(s.tag=o,o.linkCtx=s),n.ctx=U(n.ctx,(s?s.view:t).ctx),a(o,n)}o._er=r&&i,o.ctx=n.ctx||o.ctx||{},n.ctx=void 0,i=o.cvtArgs()[0],o._er=r&&i}else i=n.args[0];return null!=(i=d&&t._.onRender?t._.onRender(i,t,o):i)?i:""}function w(e,t){var n,r,a,o,s,i,l,p=this;if(p.tagName){if(!(p=((i=p).tagCtxs||[p])[e||0]))return}else i=p.tag;if(s=i.bindFrom,o=p.args,(l=i.convert)&&""+l===l&&(l="true"===l?void 0:p.view.getRsc("converters",l)||R("Unknown converter: '"+l+"'")),l&&!t&&(o=o.slice()),s){for(a=[],n=s.length;n--;)r=s[n],a.unshift(_(p,r));t&&(o=a)}if(l){if(void 0===(l=l.apply(i,a||o)))return o;if(n=(s=s||[0]).length,le(l)&&(!1===l.arg0||1!==n&&l.length===n&&!l.arg0)||(l=[l],s=[0],n=1),t)o=l;else for(;n--;)+(r=s[n])===r&&(o[r]=l[n])}return o}function _(e,t){return(e=e[+t===t?"args":"props"])&&e[t]}function y(e){return this.cvtArgs(e,1)}function b(e,t){var n,r,a=this;if(""+t===t){for(;void 0===n&&a;)n=(r=a.tmpl&&a.tmpl[e])&&r[t],a=a.parent;return n||oe[e][t]}}function x(e,t,n,r,o,s){function i(e){var t=l[e];if(void 0!==t)for(t=le(t)?t:[t],f=t.length;f--;)V=t[f],isNaN(parseInt(V))||(t[f]=parseInt(V));return t||[0]}var l,p,c,d,u,m,f,h,v,b,x,A,C,M,k,T,F,L,P,G,j,$,I,N,V,D,O,H,q,B=0,z="",W=(t=t||ae)._lc||!1,J=t.ctx,K=n||t.tmpl,Q="number"==typeof r&&t.tmpl.bnds[r-1];for("tag"===e._is?(e=(l=e).tagName,r=l.tagCtxs,l.template):(p=t.getRsc("tags",e)||R("Unknown tag: {{"+e+"}} ")).template,void 0===s&&Q&&(Q._lr=p.lateRender&&!1!==Q._lr||Q._lr)&&(s=""),void 0!==s?(z+=s,r=s=[{props:{},args:[],params:{props:{}}}]):Q&&(r=Q(t.data,t,me)),m=r.length;B<m;B++)T=(b=r[B]).tmpl,(!W||!W.tag||B&&!W.tag.inline||l._er||T&&+T===T)&&(T&&K.tmpls&&(b.tmpl=b.content=K.tmpls[T-1]),b.index=B,b.ctxPrm=g,b.render=E,b.cvtArgs=w,b.bndArgs=y,b.view=t,b.ctx=U(U(b.ctx,p&&p.ctx),J)),(n=b.props.tmpl)&&(b.tmpl=t._getTmpl(n),b.content=b.content||b.tmpl),l?W&&W.fn._lr&&(F=!!l.init):(F=!!(l=new p._ctr).init,l.parent=u=J&&J.tag,l.tagCtxs=r,W&&(l.inline=!1,W.tag=l),l.linkCtx=W,(l._.bnd=Q||W.fn)?(l._.ths=b.params.props["this"],l._.lt=r.lt,l._.arrVws={}):l.dataBoundOnly&&R(e+" must be data-bound:\n{^{"+e+"}}")),I=l.dataMap,b.tag=l,I&&r&&(b.map=r[B].map),l.flow||(x=b.ctx=b.ctx||{},c=l.parents=x.parentTags=J&&U(x.parentTags,J.parentTags)||{},u&&(c[u.tagName]=u),c[l.tagName]=x.tag=l,x.tagCtx=b);if(!(l._er=s)){for(a(l,r[0]),l.rendering={rndr:l.rendering},B=0;B<m;B++){if($=(b=l.tagCtx=r[B]).props,l.ctx=b.ctx,!B){if(F&&(l.init(b,W,l.ctx),F=void 0),b.args.length||!1===b.argDefault||!1===l.argDefault||(b.args=G=[b.view.data],b.params.args=["#data"]),C=i("bindTo"),void 0!==l.bindTo&&(l.bindTo=C),void 0!==l.bindFrom?l.bindFrom=i("bindFrom"):l.bindTo&&(l.bindFrom=l.bindTo=C),M=l.bindFrom||C,O=C.length,D=M.length,l._.bnd&&(H=l.linkedElement)&&(l.linkedElement=H=le(H)?H:[H],O!==H.length&&R("linkedElement not same length as bindTo")),(H=l.linkedCtxParam)&&(l.linkedCtxParam=H=le(H)?H:[H],D!==H.length&&R("linkedCtxParam not same length as bindFrom/bindTo")),M)for(l._.fromIndex={},l._.toIndex={},h=D;h--;)for(V=M[h],f=O;f--;)V===C[f]&&(l._.fromIndex[f]=h,l._.toIndex[h]=f);W&&(W.attr=l.attr=W.attr||l.attr||W._dfAt),d=l.attr,l._.noVws=d&&d!==He}if(G=l.cvtArgs(B),l.linkedCtxParam)for(j=l.cvtArgs(B,1),f=D,q=l.constructor.prototype.ctx;f--;)(A=l.linkedCtxParam[f])&&(V=M[f],k=j[f],b.ctx[A]=me._cp(q&&void 0===k?q[A]:k,void 0!==k&&_(b.params,V),b.view,l._.bnd&&{tag:l,cvt:l.convert,ind:f,tagElse:B}));(L=$.dataMap||I)&&(G.length||$.dataMap)&&((P=b.map)&&P.src===G[0]&&!o||(P&&P.src&&P.unmap(),L.map(G[0],b,P,!l._.bnd),P=b.map),G=[P.tgt]),v=void 0,l.render&&(v=l.render.apply(l,G),t.linked&&v&&!Ie.test(v)&&((n={links:[]}).render=n.fn=function(){return v},v=S(n,t.data,void 0,!0,t,void 0,void 0,l))),G.length||(G=[t]),void 0===v&&(N=G[0],l.contentCtx&&(N=!0===l.contentCtx?t:l.contentCtx(N)),v=b.render(N,!0)||(o?void 0:"")),z=z?z+(v||""):void 0!==v?""+v:void 0}l.rendering=l.rendering.rndr}return l.tagCtx=r[0],l.ctx=l.tagCtx.ctx,l._.noVws&&l.inline&&(z="text"===d?ce.html(z):""),Q&&t._.onRender?t._.onRender(z,t,l):z}function A(e,t,n,r,a,o,s,i){var l,p,c,d=this,m="array"===t;d.content=i,d.views=m?[]:{},d.data=r,d.tmpl=a,c=d._={key:0,useKey:m?0:1,id:""+Ve++,onRender:s,bnds:{}},d.linked=!!s,d.type=t||"top",t&&(d.cache={_ct:fe._cchCt}),n&&"top"!==n.type||((d.ctx=e||{}).root=d.data),(d.parent=n)?(d.root=n.root||d,l=n.views,p=n._,d.isTop=p.scp,d.scope=(!e.tag||e.tag===n.ctx.tag)&&!d.isTop&&n.scope||d,p.useKey?(l[c.key="_"+p.useKey++]=d,d.index=Ue,d.getIndex=u):l.length===(c.key=d.index=o)?l.push(d):l.splice(o,0,d),d.ctx=e||n.ctx):t&&(d.root=d)}function C(e){var t,n,r;for(t in Ze)e[n=t+"s"]&&(r=e[n],e[n]={},oe[n](r,e))}function M(e,t,n){function a(){var t=this;t._={unlinked:!0},t.inline=!0,t.tagName=e}var o,s,i,l=new me._tg;if(ie(t)?t={depends:t.depends,render:t}:""+t===t&&(t={template:t}),s=t.baseTag)for(i in t.flow=!!t.flow,(s=""+s===s?n&&n.tags[s]||ue[s]:s)||R('baseTag: "'+t.baseTag+'" not found'),l=p(l,s),t)l[i]=r(s[i],t[i]);else l=p(l,t);return void 0!==(o=l.template)&&(l.template=""+o===o?pe[o]||pe(o):o),(a.prototype=l).constructor=l._ctr=a,n&&(l._parentTmpl=n),l}function k(e){return this.base.apply(this,e)}function T(e,n,r,a){function o(n){var o,i;if(""+n===n||n.nodeType>0&&(s=n)){if(!s)if(/^\.?\/[^\\:*?"<>]*$/.test(n))(i=pe[e=e||n])?n=i:s=document.getElementById(n);else if(t.fn&&!me.rTmpl.test(n))try{s=t(n,document)[0]}catch(l){}s&&("SCRIPT"!==s.tagName&&R(n+": Use script block, not "+s.tagName),a?n=s.innerHTML:((o=s.getAttribute(Be))&&(o!==ze?(n=pe[o],delete pe[o]):t.fn&&(n=t.data(s)[ze])),o&&n||(n=T(e=e||(t.fn?ze:n),s.innerHTML,r,a)),n.tmplName=e=e||o,e!==ze&&(pe[e]=n),s.setAttribute(Be,e),t.fn&&t.data(s,ze,n))),s=void 0}else n.fn||(n=void 0);return n}var s,i,l=n=n||"";if(me._html=ce.html,0===a&&(a=void 0,l=o(l)),(a=a||(n.markup?n.bnds?p({},n):n:{})).tmplName=a.tmplName||e||"unnamed",r&&(a._parentTmpl=r),!l&&n.markup&&(l=o(n.markup))&&l.fn&&(l=l.markup),void 0!==l)return l.render||n.render?l.tmpls&&(i=l):(n=G(l,a),D(l.replace(Fe,"\\$&"),n)),i||C(i=p(function(){return i.render.apply(i,arguments)},n)),i}function F(e,t){return ie(e)?e.call(t):e}function L(e,t,n){Object.defineProperty(e,t,{value:n,configurable:!0})}function P(e,n){function r(e){c.apply(this,e)}function a(){return new r(arguments)}function o(e,t){for(var n,r,a,o,s,i=0;i<_;i++)n=void 0,(a=m[i])+""!==a&&(a=(n=a).getter,s=n.parentRef),void 0===(o=e[a])&&n&&void 0!==(r=n.defaultVal)&&(o=F(r,e)),t(o,n&&u[n.type],a,s)}function s(t){var n,r,a,s,p=0,c=t=t+""===t?JSON.parse(t):t,d=[];if(le(t)){for(n=(t=t||[]).length;p<n;p++)d.push(this.map(t[p]));return d._is=e,d.unmap=l,d.merge=i,d}if(t){for(o(t,function(e,t){t&&(e=t.map(e)),d.push(e)}),c=this.apply(this,d),p=_;p--;)if(a=d[p],(s=m[p].parentRef)&&a&&a.unmap)if(le(a))for(n=a.length;n--;)L(a[n],s,c);else L(a,s,c);for(r in t)r===se||b[r]||(c[r]=t[r])}return c}function i(e,t,n){e=e+""===e?JSON.parse(e):e;var r,s,i,l,p,c,d,u,m,f,h=0,v=this;if(le(v)){for(d={},m=[],s=e.length,i=v.length;h<s;h++){for(u=e[h],c=!1,r=0;r<i&&!c;r++)d[r]||(p=v[r],g&&(d[r]=c=g+""===g?u[g]&&(b[g]?p[g]():p[g])===u[g]:g(p,u)));c?(p.merge(u),m.push(p)):(m.push(f=a.map(u)),n&&L(f,n,t))}y?y(v).refresh(m,!0):v.splice.apply(v,[0,v.length].concat(m))}else for(l in o(e,function(e,t,n,r){t?v[n]().merge(e,v,r):v[n]()!==e&&v[n](e)}),e)l===se||b[l]||(v[l]=e[l])}function l(){function e(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n].unmap());return t}var t,n,r,a,o=0,s=this;if(le(s))return e(s);for(t={};o<_;o++)r=void 0,(n=m[o])+""!==n&&(n=(r=n).getter),a=s[n](),t[n]=r&&a&&u[r.type]?le(a)?e(a):a.unmap():a;for(n in s)!s.hasOwnProperty(n)||"_"===n.charAt(0)&&b[n.slice(1)]||n===se||ie(s[n])||(t[n]=s[n]);return t}var p,c,d,u=this,m=n.getters,f=n.extend,g=n.id,h=t.extend({_is:e||"unnamed",unmap:l,merge:i},f),v="",w="",_=m?m.length:0,y=t.observable,b={};for(r.prototype=h,p=0;p<_;p++)!function(e){e=e.getter||e,b[e]=p+1;var t="_"+e;v+=(v?",":"")+e,w+="this."+t+" = "+e+";\n",h[e]=h[e]||function(n){return arguments.length?void(y?y(this).setProperty(e,n):this[t]=n):this[t]},y&&(h[e].set=h[e].set||function(e){this[t]=e})}(m[p]);return w=new Function(v,w),(c=function(){w.apply(this,arguments),(d=arguments[_+1])&&L(this,arguments[_],d)}).prototype=h,h.constructor=c,a.map=s,a.getters=m,a.extend=f,a.id=g,a}function G(e,n){var r,a=ge._wm||{},o={tmpls:[],links:{},bnds:[],_is:"template",render:E};return n&&(o=p(o,n)),o.markup=e,o.htmlTag||(r=Ge.exec(e),o.htmlTag=r?r[1].toLowerCase():""),(r=a[o.htmlTag])&&r!==a.div&&(o.markup=t.trim(o.markup)),o}function j(e,t){function n(a,o,s){var i,l,p,c=me.onStore[e];if(a&&typeof a===qe&&!a.nodeType&&!a.markup&&!a.getTgt&&!("viewModel"===e&&a.getters||a.extend)){for(l in a)n(l,a[l],o);return o||oe}return a&&""+a!==a&&(s=o,o=a,a=void 0),p=s?"viewModel"===e?s:s[r]=s[r]||{}:n,i=t.compile,void 0===o&&(o=i?a:p[a],a=void 0),null===o?a&&delete p[a]:(i&&((o=i.call(p,a,o,s,0)||{})._is=e),a&&(p[a]=o)),c&&c(a,o,s,i),o}var r=e+"s";oe[r]=n}function $(e){he[e]=he[e]||function(t){return arguments.length?(fe[e]=t,he):fe[e]}}function I(e){function t(t,n){this.tgt=e.getTgt(t,n),n.map=this}return ie(e)&&(e={getTgt:e}),e.baseMap&&(e=p(p({},e.baseMap),e)),e.map=function(e,n){return new t(e,n)},e}function E(e,t,n,r,a,o){var s,i,l,p,c,d,u,m,f=r,g="";if(!0===t?(n=t,t=void 0):typeof t!==qe&&(t=void 0),(l=this.tag)?(c=this,p=(f=f||c.view)._getTmpl(l.template||c.tmpl),arguments.length||(e=l.contentCtx&&ie(l.contentCtx)?e=l.contentCtx(e):f)):p=this,p){if(!r&&e&&"view"===e._is&&(f=e),f&&e===f&&(e=f.data),d=!f,Ae=Ae||d,d&&((t=t||{}).root=e),!Ae||ge.useViews||p.useViews||f&&f!==ae)g=S(p,e,t,n,f,a,o,l);else{if(f?(u=f.data,m=f.index,f.index=Ue):(u=(f=ae).data,f.data=e,f.ctx=t),le(e)&&!n)for(s=0,i=e.length;s<i;s++)f.index=s,f.data=e[s],g+=p.fn(e[s],f,me);else f.data=e,g+=p.fn(e,f,me);f.data=u,f.index=m}d&&(Ae=void 0)}return g}function S(e,t,n,r,a,o,s,i){var l,c,d,u,m,f,g,h,v,w,_,y,b,x="";if(i&&(v=i.tagName,y=i.tagCtx,n=n?U(n,i.ctx):i.ctx,e===a.content?g=e!==a.ctx._wrp?a.ctx._wrp:void 0:e!==y.content?e===i.template?(g=y.tmpl,n._wrp=y.content):g=y.content||a.content:g=a.content,!1===y.props.link&&((n=n||{}).link=!1)),a&&(s=s||a._.onRender,(b=n&&!1===n.link)&&a._.nl&&(s=void 0),n=U(n,a.ctx),y=!i&&a.tag?a.tag.tagCtxs[a.tagElse]:y),(w=y&&y.props.itemVar)&&("~"!==w[0]&&V("Use itemVar='~myItem'"),w=w.slice(1)),!0===o&&(f=!0,o=0),s&&i&&i._.noVws&&(s=void 0),h=s,!0===s&&(h=void 0,s=a._.onRender),_=n=e.helpers?U(e.helpers,n):n,le(t)&&!r)for((d=f?a:void 0!==o&&a||new A(n,"array",a,t,e,o,s,g))._.nl=b,a&&a._.useKey&&(d._.bnd=!i||i._.bnd&&i,d.tag=i),l=0,c=t.length;l<c;l++)u=new A(_,"item",d,t[l],e,(o||0)+l,s,d.content),w&&((u.ctx=p({},_))[w]=me._cp(t[l],"#data",u)),m=e.fn(t[l],u,me),x+=d._.onRender?d._.onRender(m,u):m;else d=f?a:new A(_,v||"data",a,t,e,o,s,g),w&&((d.ctx=p({},_))[w]=me._cp(t,"#data",d)),d.tag=i,d._.nl=b,x+=e.fn(t,d,me);return i&&(d.tagElse=y.index,y.contentView=d),h?h(x,d):x}function N(e,t,n){var r=void 0!==n?ie(n)?n.call(t.data,e,t):n||"":"{Error: "+(e.message||e)+"}";return fe.onError&&void 0!==(n=fe.onError.call(t.data,e,n&&r,t))&&(r=n),t&&!t._lc?ce.html(r):r}function R(e){throw new me.Err(e)}function V(e){R("Syntax error\n"+e)}function D(e,t,n,r,a){function o(t){(t-=g)&&v.push(e.substr(g,t).replace(ke,"\\n"))}function s(t,n){t&&(t+="}}",V((n?"{{"+n+"}} block has {{/"+t+" without {{"+t:"Unmatched or missing {{/"+t)+", in template:\n"+e))}function i(i,l,p,u,f,_,y,b,x,A,C,M){(y&&l||x&&!p||b&&":"===b.slice(-1)||A)&&V(i),_&&(f=":",u=He);var k,T,F,L=(l||n)&&[[]],P="",G="",j="",$="",I="",E="",S="",N="",R=!(x=x||n&&!a)&&!f;p=p||(b=b||"#data",f),o(M),g=M+i.length,y?m&&v.push(["*","\n"+b.replace(/^:/,"ret+= ").replace(Te,"$1")+";\n"]):p?("else"===p&&(Pe.test(b)&&V('For "{{else if expr}}" use "{{else expr}}"'),L=w[9]&&[[]],w[10]=e.substring(w[10],M),T=w[11]||w[0]||V("Mismatched: "+i),w=h.pop(),v=w[2],R=!0),b&&B(b.replace(ke," "),L,t,n).replace(Le,function(e,t,n,r,a,o,s,i){return"this:"===r&&(o="undefined"),i&&(F=F||"@"===i[0]),r="'"+a+"':",s?(G+=n+o+",",$+="'"+i+"',"):n?(j+=r+"j._cp("+o+',"'+i+'",view),',E+=r+"'"+i+"',"):t?S+=o:("trigger"===a&&(N+=o),"lateRender"===a&&(k="false"!==i),P+=r+o+",",I+=r+"'"+i+"',",d=d||$e.test(a)),""}).slice(0,-1),L&&L[0]&&L.pop(),c=[p,u||!!r||d||"",R&&[],H($||(":"===p?"'#data',":""),I,E),H(G||(":"===p?"data,":""),P,j),S,N,k,F,L||0],v.push(c),R&&(h.push(w),(w=c)[10]=g,w[11]=T)):C&&(s(C!==w[0]&&C!==w[11]&&C,w[0]),w[10]=e.substring(w[10],M),w=h.pop()),s(!w&&C),v=w[2]}var l,p,c,d,u,m=fe.allowCode||t&&t.allowCode||!0===he.allowCode,f=[],g=0,h=[],v=f,w=[,,f];if(m&&t._is&&(t.allowCode=m),n&&(void 0!==r&&(e=e.slice(0,-r.length-2)+_e),e=ve+e+ye),s(h[0]&&h[0][2].pop()[0]),e.replace(re,i),o(e.length),(g=f[f.length-1])&&s(""+g!==g&&+g[10]===g[10]&&g[0]),n){for(p=z(f,e,n),u=[],l=f.length;l--;)u.unshift(f[l][9]);O(p,u)}else p=z(f,t);return p}function O(e,t){var n,r,a=0,o=t.length;for(e.deps=[],e.paths=[];a<o;a++)for(n in e.paths.push(r=t[a]),r)"_jsvto"!==n&&r.hasOwnProperty(n)&&r[n].length&&!r[n].skp&&(e.deps=e.deps.concat(r[n]))}function H(e,t,n){return[e.slice(0,-1),t.slice(0,-1),n.slice(0,-1)]}function q(e,t){return"\n\tparams:{args:["+e[0]+"],\n\tprops:{"+e[1]+"}"+(e[2]?",\n\tctx:{"+e[2]+"}":"")+"},\n\targs:["+t[0]+"],\n\tprops:{"+t[1]+"}"+(t[2]?",\n\tctx:{"+t[2]+"}":"")}function B(e,n,r,a){function o(r,o,l,M,k,T,F,L,P,G,j,$,I,E,S,N,R,D,O,H,q){function B(e,t,r,o,l,p,c,m){if(K="."===r,r&&(k=k.slice(t.length),/^\.?constructor$/.test(m||k)&&V(e),K||(e=(G?(a?"":"(ltOb.lt=ltOb.lt||")+"(ob=":"")+(o?'view.ctxPrm("'+o+'")':l?"view":"data")+(G?")===undefined"+(a?"":")")+'?"":view._getOb(ob,"':"")+(m?(p?"."+p:o?"":l?"":"."+r)+(c||""):(m=o?"":l?p||"":r,"")),e=t+("view.data"===(e+=m?"."+m:"").slice(0,9)?e.slice(5):e)+(G?(a?'"':'",ltOb')+(j?",1)":")"):"")),d)){if(U="_linkTo"===s?i=n._jsvto=n._jsvto||[]:u.bd,W=K&&U[U.length-1]){if(W._cpfn){for(;W.sb;)W=W.sb;W.prm&&(W.bnd&&(k="^"+k.slice(1)),W.sb=k,W.bnd=W.bnd||"^"===k[0])}}else U.push(k);j&&!K&&(b[h]=X,x[h]=A[h].length)}return e}M&&!L&&(k=M+k),T=T||"",I=I||"",l=l||o||I,k=k||P,G&&(G=!/\)|]/.test(q[H-1]))&&(k=k.slice(1).split(".").join("^")),j=j||D||"";var z,U,W,J,K,Q,Z,X=H;if(!c&&!p){if(F&&V(e),R&&d){if(z=b[h-1],q.length-1>X-(z||0)){if(z=t.trim(q.slice(z,X+r.length)),U=i||m[h-1].bd,(W=U[U.length-1])&&W.prm){for(;W.sb&&W.sb.prm;)W=W.sb;J=W.sb={path:W.sb,bnd:W.bnd}}else U.push(J={path:U.pop()});W&&W.sb===J&&(A[h]=A[h-1].slice(W._cpPthSt)+A[h],A[h-1]=A[h-1].slice(0,W._cpPthSt)),J._cpPthSt=x[h-1],J._cpKey=z,A[h]+=q.slice(C,H),C=H,J._cpfn=We[z]=We[z]||new Function("data,view,j","//"+z+"\nvar v;\nreturn ((v="+A[h]+("]"===N?")]":N)+")!=null?v:null);"),A[h-1]+=y[g]&&ge.cache?'view.getCache("'+z.replace(Fe,"\\$&")+'"':A[h],J.prm=u.bd,J.bnd=J.bnd||J.path&&J.path.indexOf("^")>=0}A[h]=""}"["===j&&(j="[j._sq("),"["===l&&(l="[j._sq(")}return Z=c?(c=!E)?r:I+'"':p?(p=!S)?r:I+'"':(l?(_[++g]=!0,v[g]=0,d&&(b[h++]=X++,u=m[h]={bd:[]},A[h]="",x[h]=1),l):"")+(O?g?"":(f=q.slice(f,X),(s?(s=i=!1,"\b"):"\b,")+f+(f=X+r.length,d&&n.push(u.bd=[]),"\b")):L?(h&&V(e),d&&n.pop(),s="_"+k,M,f=X+r.length,d&&((d=u.bd=n[s]=[]).skp=!M),k+":"):k?k.split("^").join(".").replace(me.rPath,B)+(j||T):T||(N?"]"===N?")]":")":$?(y[g]||V(e),","):o?"":(c=E,p=S,'"'))),c||p||N&&(y[g]=!1,g--),d&&(c||p||(N&&(_[g+1]&&(u=m[--h],_[g+1]=!1),w=v[g+1]),j&&(v[g+1]=A[h].length+(l?1:0),(k||N)&&(u=m[++h]={bd:[]},_[g+1]=!0))),A[h]=(A[h]||"")+q.slice(C,H),C=H+r.length,c||p||((Q=l&&_[g+1])&&(A[h-1]+=l,x[h-1]++),"("===j&&K&&!J&&(A[h]=A[h-1].slice(w)+A[h],A[h-1]=A[h-1].slice(0,w))),A[h]+=Q?Z.slice(1):Z),c||p||!j||(g++,k&&"("===j&&(y[g]=!0)),c||p||!D||(d&&(A[h]+=j),Z+=j),Z}var s,i,l,p,c,d=n&&n[0],u={bd:d},m={0:u},f=0,g=0,h=0,v={},w=0,_={},y={},b={},x={0:0},A={0:""},C=0;return"@"===e[0]&&(e=e.replace(Re,".")),l=(e+(r?" ":"")).replace(me.rPrm,o),d&&(l=A[0]),!g&&l||V(e)}function z(e,t,n){var r,a,o,s,i,l,p,c,d,u,m,f,g,h,v,w,_,y,b,x,A,C,M,k,T,F,L,P,j,$,I,E,S=0,N=ge.useViews||t.useViews||t.tags||t.templates||t.helpers||t.converters,R="",D={},H=e.length;for(""+t===t?(_=n?'data-link="'+t.replace(ke," ").slice(1,-1)+'"':t,t=0):(_=t.tmplName||"unnamed",t.allowCode&&(D.allowCode=!0),t.debug&&(D.debug=!0),u=t.bnds,w=t.tmpls),r=0;r<H;r++)if(""+(a=e[r])===a)R+='+"'+a+'"';else if("*"===(o=a[0]))R+=";\n"+a[1]+"\nret=ret";else{if(s=a[1],x=!n&&a[2],i=q(a[3],f=a[4]),j=a[6],$=a[7],a[8]?(I="\nvar ob,ltOb={},ctxs=",E=";\nctxs.lt=ltOb.lt;\nreturn ctxs;"):(I="\nreturn ",E=""),A=a[10]&&a[10].replace(Te,"$1"),(k="else"===o)?m&&m.push(a[9]):(L=a[5]||!1!==fe.debugMode&&"undefined",u&&(m=a[9])&&(m=[m],S=u.push(1))),N=N||f[1]||f[2]||m||/view.(?!index)/.test(f[0]),(T=":"===o)?s&&(o=s===He?">":s+o):(x&&((y=G(A,D)).tmplName=_+"/"+o,y.useViews=y.useViews||N,z(x,y),N=y.useViews,w.push(y)),k||(b=o,N=N||o&&(!ue[o]||!ue[o].flow),M=R,R=""),C=(C=e[r+1])&&"else"===C[0]),P=L?";\ntry{\nret+=":"\n+",g="",h="",T&&(m||j||s&&s!==He||$)){if((F=new Function("data,view,j","// "+_+" "+ ++S+" "+o+I+"{"+i+"};"+E))._er=L,F._tag=o,F._bd=!!m,F._lr=$,n)return F;O(F,m),d=!0,g=(v='c("'+s+'",view,')+S+",",h=")"}if(R+=T?(n?(L?"try{\n":"")+"return ":P)+(d?(d=void 0,N=c=!0,v+(F?(u[S-1]=F,S):"{"+i+"}")+")"):">"===o?(p=!0,"h("+f[0]+")"):(!0,"((v="+f[0]+")!=null?v:"+(n?"null)":'"")'))):(l=!0,"\n{view:view,content:false,tmpl:"+(x?w.length:"false")+","+i+"},"),b&&!C){if(R="["+R.slice(0,-1)+"]",v='t("'+b+'",view,this,',n||m){if((R=new Function("data,view,j"," // "+_+" "+S+" "+b+I+R+E))._er=L,R._tag=b,m&&O(u[S-1]=R,m),R._lr=$,n)return R;g=v+S+",undefined,",h=")"}R=M+P+v+(m&&S||R)+")",m=0,b=0}L&&!C&&(N=!0,R+=";\n}catch(e){ret"+(n?"urn ":"+=")+g+"j._err(e,view,"+L+")"+h+";}"+(n?"":"\nret=ret"))}R="// "+_+(D.debug?"\ndebugger;":"")+"\nvar v"+(l?",t=j._tag":"")+(c?",c=j._cnvt":"")+(p?",h=j._html":"")+(n?(a[8]?", ob":"")+";\n":',ret=""')+R+(n?"\n":";\nreturn ret;");try{R=new Function("data,view,j",R)}catch(U){V("Compiled template code:\n\n"+R+'\n: "'+(U.message||U)+'"')}return t&&(t.fn=R,t.useViews=!!N),R}function U(e,t){return e&&e!==t?t?p(p({},t),e):e:t&&p({},t)}function W(e,n){var r,a,o=n.map,s=o&&o.propsArr;if(!s){if(s=[],typeof e===qe||ie(e))for(r in e)a=e[r],r===se||!e.hasOwnProperty(r)||n.props.noFunctions&&t.isFunction(a)||s.push({key:r,prop:a});o&&(o.propsArr=o.options&&s)}return J(s,n)}function J(e,n){var r,a,o,s=n.tag,i=n.props,l=n.params.props,p=i.filter,c=i.sort,d=!0===c,u=parseInt(i.step),m=i.reverse?-1:1;if(!le(e))return e;if(d||c&&""+c===c?((r=e.map(function(e,t){return{i:t,v:""+(e=d?e:f(e,c))===e?e.toLowerCase():e}})).sort(function(e,t){return e.v>t.v?m:e.v<t.v?-m:0}),e=r.map(function(t){return e[t.i]})):(c||m<0)&&!s.dataMap&&(e=e.slice()),ie(c)&&(e=e.sort(function(){return c.apply(n,arguments)})),m<0&&(!c||ie(c))&&(e=e.reverse()),e.filter&&p&&(e=e.filter(p,n),n.tag.onFilter&&n.tag.onFilter(n)),l.sorted&&(r=c||m<0?e:e.slice(),s.sorted?t.observable(s.sorted).refresh(r):n.map.sorted=r),a=i.start,o=i.end,(l.start&&void 0===a||l.end&&void 0===o)&&(a=o=0),isNaN(a)&&isNaN(o)||(a=+a||0,o=void 0===o||o>e.length?e.length:+o,e=e.slice(a,o)),u>1){for(a=0,o=e.length,r=[];a<o;a+=u)r.push(e[a]);e=r}return l.paged&&s.paged&&$observable(s.paged).refresh(e),e}function K(e,n,r){var a=this.jquery&&(this[0]||R("Unknown template")),o=a.getAttribute(Be);return E.call(o&&t.data(a)[ze]||pe(a),e,n,r)}function Q(e){return De[e]||(De[e]="&#"+e.charCodeAt(0)+";")}function Z(e,t){return Oe[t]||""}function X(e){return null!=e?je.test(e)&&(""+e).replace(Ee,Q)||e:""}function Y(e){return""+e===e?e.replace(Se,Q):e}function ee(e){return""+e===e?e.replace(Ne,Z):e}var te=!1===t;t=t&&t.fn?t:e.jQuery;var ne,re,ae,oe,se,ie,le,pe,ce,de,ue,me,fe,ge,he,ve,we,_e,ye,be,xe,Ae,Ce="v1.0.9",Me="_ocp",ke=/[ \t]*(\r\n|\n|\r)/g,Te=/\\(['"\\])/g,Fe=/['"\\]/g,Le=/(?:\x08|^)(onerror:)?(?:(~?)(([\w$.]+):)?([^\x08]+))\x08(,)?([^\x08]+)/gi,Pe=/^if\s/,Ge=/<(\w+)[>\s]/,je=/[\x00`><\"'&=]/,$e=/^on[A-Z]|^convert(Back)?$/,Ie=/^\#\d+_`[\s\S]*\/\d+_`$/,Ee=/[\x00`><"'&=]/g,Se=/[&<>]/g,Ne=/&(amp|gt|lt);/g,Re=/\[['"]?|['"]?\]/g,Ve=0,De={"&":"&amp;","<":"&lt;",">":"&gt;","\0":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;","=":"&#61;"},Oe={amp:"&",gt:">",lt:"<"},He="html",qe="object",Be="data-jsv-tmpl",ze="jsvTmpl",Ue="For #index in nested block use #getIndex().",We={},Je={},Ke=e.jsrender,Qe=Ke&&t&&!t.render,Ze={template:{compile:T},tag:{compile:M},viewModel:{compile:P},helper:{},converter:{}};if(oe={jsviews:Ce,sub:{rPath:/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,rPrm:/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(~?[\w$.^]+)?\s*((\+\+|--)|\+|-|~(?![\w$])|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?(@)?[#~]?[\w$.^]+)([([])?)|(,\s*)|(?:(\()\s*)?\\?(?:(')|("))|(?:\s*(([)\]])(?=[.^]|\s*$|[^([])|[)\]])([([]?))|(\s+)/g,View:A,Err:l,tmplFn:D,parse:B,extend:p,extendCtx:U,syntaxErr:V,onStore:{template:function(e,t){
null===t?delete Je[e]:e&&(Je[e]=t)}},addSetting:$,settings:{allowCode:!1},advSet:s,_thp:a,_gm:r,_tg:function(){},_cnvt:v,_tag:x,_er:R,_err:N,_cp:o,_sq:function(e){return"constructor"===e&&V(""),e}},settings:{delimiters:c,advanced:function(e){return e?(p(ge,e),me.advSet(),he):ge}},map:I},(l.prototype=new Error).constructor=l,u.depends=function(){return[this.get("item"),"index"]},m.depends="index",A.prototype={get:d,getIndex:m,ctxPrm:g,getRsc:b,_getTmpl:h,_getOb:f,getCache:function(e){return fe._cchCt>this.cache._ct&&(this.cache={_ct:fe._cchCt}),void 0!==this.cache[e]?this.cache[e]:this.cache[e]=We[e](this.data,this,me)},_is:"view"},me=oe.sub,he=oe.settings,!(Ke||t&&t.render)){for(ne in Ze)j(ne,Ze[ne]);if(ce=oe.converters,de=oe.helpers,ue=oe.tags,me._tg.prototype={baseApply:k,cvtArgs:w,bndArgs:y,ctxPrm:g},ae=me.topView=new A,t){if(t.fn.render=K,se=t.expando,t.observable){if(Ce!==(Ce=t.views.jsviews))throw"jquery.observable.js requires jsrender.js "+Ce;p(me,t.views.sub),oe.map=t.views.map}}else t={},te&&(e.jsrender=t),t.renderFile=t.__express=t.compile=function(){throw"Node.js: use npm jsrender, or jsrender-node.js"},t.isFunction=function(e){return"function"==typeof e},t.isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},me._jq=function(e){e!==t&&(p(e,t),(t=e).fn.render=K,delete t.jsrender,se=t.expando)},t.jsrender=Ce;for(xe in(fe=me.settings).allowCode=!1,ie=t.isFunction,t.render=Je,t.views=oe,t.templates=pe=oe.templates,fe)$(xe);(he.debugMode=function(e){return void 0===e?fe.debugMode:(fe._clFns&&fe._clFns(),fe.debugMode=e,fe.onError=e+""===e?function(){return e}:ie(e)?e:void 0,he)})(!1),ge=fe.advanced={cache:!0,useViews:!1,_jsv:!1},ue({"if":{render:function(e){var t=this,n=t.tagCtx;return t.rendering.done||!e&&(n.args.length||!n.index)?"":(t.rendering.done=!0,void(t.selected=n.index))},contentCtx:!0,flow:!0},"for":{sortDataMap:I(J),init:function(){this.setDataMap(this.tagCtxs)},render:function(e){var t,n,r,a,o,s=this,i=s.tagCtx,l=!1===i.argDefault,p=i.props,c=l||i.args.length,d="",u=0;if(!s.rendering.done){if(t=c?e:i.view.data,l)for(l=p.reverse?"unshift":"push",a=+p.end,o=+p.step||1,t=[],r=+p.start||0;(a-r)*o>0;r+=o)t[l](r);void 0!==t&&(n=le(t),d+=i.render(t,!c||p.noIteration),u+=n?t.length:1),(s.rendering.done=u)&&(s.selected=i.index)}return d},setDataMap:function(e){for(var t,n,r,a=this,o=e.length;o--;)n=(t=e[o]).props,r=t.params.props,t.argDefault=void 0===n.end||t.args.length>0,n.dataMap=!1!==t.argDefault&&le(t.args[0])&&(r.sort||r.start||r.end||r.step||r.filter||r.reverse||n.sort||n.start||n.end||n.step||n.filter||n.reverse)&&a.sortDataMap},flow:!0},props:{baseTag:"for",dataMap:I(W),init:s,flow:!0},include:{flow:!0},"*":{render:o,flow:!0},":*":{render:o,flow:!0},dbg:de.dbg=ce.dbg=i}),ce({html:X,attr:X,encode:Y,unencode:ee,url:function(e){return null!=e?encodeURI(""+e):null===e?e:""}})}return fe=me.settings,le=(t||Ke).isArray,he.delimiters("{{","}}","^"),Qe&&Ke.views.sub._jq(t),t||Ke},window),function(e){var t=e.AwesomeMap,n=t.getCategory,r=t.layers,a="marker-meeting-popup",o="marker-proposal-popup",s=[],i=function(e,t,i){var l="proposals"===i.type?o:a,p=document.createElement("div");$($.templates("#"+l).render(e)).appendTo(p),t.bindPopup(p,{maxwidth:640,minWidth:500,keepInView:!0,className:"map-info"}).openPopup(),s.push({marker:t,component:i,element:e});var c=n(e.category);if(r[c.id]){$("#awesome_map-categories-control").show(),t.addTo(r[c.id].group);var d=$("label.awesome_map-category-"+c.id),u=$("label.awesome_map-category-"+c.parent);d.show(),d.attr("title",parseInt(d.attr("title")||0)+1+" "+window.DecidimAwesome.texts.items),u.show(),u.attr("title",parseInt(u.attr("title")||0)+1+" "+window.DecidimAwesome.texts.items)}var m=$("#awesome_map-component_"+i.id);return m.attr("title",parseInt(m.attr("title")||0)+1),t};e.AwesomeMap.allMarkers=s,e.AwesomeMap.drawMarker=i}(window);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ApiFetcher=function(){function e(t,n){_classCallCheck(this,e),this.query=t,this.variables=n}return _createClass(e,[{key:"fetch",value:function(e){$.ajax({method:"POST",url:"/api",contentType:"application/json",data:JSON.stringify({query:this.query,variables:this.variables})}).done(function(t){e(t.data)})}},{key:"fetchAll",value:function(e){this.fetch(e)}}],[{key:"findTranslation",value:function(e){var t=undefined,n=document.querySelector("html").getAttribute("lang");return e.forEach(function(e){e.text&&(t&&e.locale!=n||(t=e.text))}),t}}]),e}();!function(e){var t=e.AwesomeMap,n=t.getCategory,r=t.truncate,a=t.collectHashtags,o=t.removeHashtags,s=t.appendHtmlHashtags,i="query ($id: ID!, $after: String!) {\n    component(id: $id) {\n        id\n        __typename\n        ... on Proposals {\n          proposals(first: 50, after: $after){\n            pageInfo {\n              hasNextPage\n              endCursor\n            }\n            edges {\n              node {\n                id\n                state\n                title {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                body {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                address\n                coordinates {\n                  latitude\n                  longitude\n                }\n                amendments {\n                  emendation {\n                    id\n                  }\n                }\n                category {\n                  id\n                }\n              }\n            }\n          }\n        }\n      }\n    }",l=[],p=L.DivIcon.SVGIcon.DecidimIcon,c=function(e,t){var i=L.marker([e.coordinates.latitude,e.coordinates.longitude],{icon:new p({fillColor:n(e.category).color})});e.title.translation=ApiFetcher.findTranslation(e.title.translations);var l=ApiFetcher.findTranslation(e.body.translations);e.hashtags=a(l),e.body.translation=s(r(o(l)).replace(/\n/g,"<br>"),e.hashtags),t(e,i)},d=function u(e,t,n){var r=arguments.length<=3||arguments[3]===undefined?function(){}:arguments[3],a={id:e.id,after:t};new ApiFetcher(i,a).fetchAll(function(t){t&&(t.component.proposals.edges.forEach(function(t){t.node&&(t.node.coordinates&&t.node.coordinates.latitude&&t.node.coordinates.longitude&&(t.node.link=e.url+"/proposals/"+t.node.id,c(t.node,n)),t.node.amendments&&t.node.amendments.length&&t.node.amendments.forEach(function(e){l.push(e.emendation.id)}))}),t.component.proposals.pageInfo.hasNextPage?u(e,t.component.proposals.pageInfo.endCursor,n,r):r())})};e.AwesomeMap=e.AwesomeMap||{},e.AwesomeMap.fetchProposals=d,e.AwesomeMap.amendments=l}(window),function(e){var t=e.AwesomeMap,n=t.getCategory,r=t.truncate,a="query ($id: ID!, $after: String!) {\n    component(id: $id) {\n        id\n        __typename\n        ... on Meetings {\n          meetings(first: 50, after: $after) {\n            pageInfo {\n              hasNextPage\n              endCursor\n            }\n            edges {\n              node {\n                id\n                title {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                description {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                startTime\n                location {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                address\n                locationHints {\n                  translations {\n                    text\n                    locale\n                  }\n                }\n                coordinates {\n                  latitude\n                  longitude\n                }\n                category {\n                  id\n                }\n              }\n            }\n          }\n        }\n      }\n    }",o=L.DivIcon.SVGIcon.extend({options:{fillColor:"#ef604d",opacity:0},_createPathDescription:function(){return"M 15.991543,4 C 7.3956015,4 2.9250351,10.5 3.000951,16.999999 3.1063486,26.460968 12.747693,30.000004 15.991543,43 19.242091,30.000004 29,26.255134 29,16.999999 29,10.5 23.951131,4 15.996007,4 m -0.153508,2.6000001 a 2.1720294,2.1076698 0 0 1 2.330514,2.1124998 2.177008,2.1125006 0 0 1 -4.354016,0 2.1720294,2.1076698 0 0 1 2.023502,-2.1124998 m -2.651707,4.8056679 h 5.610202 l 3.935584,7.569899 -1.926038,0.934266 -2.009546,-3.859265 v 14.557403 h -2.484243 v -9.126003 h -0.642162 v 9.126003 H 13.190347 V 16.050568 l -2.009545,3.859265 -1.926036,-0.934266 3.935581,-7.569899"},_createCircle:function(){return""},_createSVG:function(){var e=this._createPath(),t=this._createCircle(),n=this._createText();return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="'+(this.options.className+"-svg")+'" style="'+("width:"+this.options.iconSize.x+"px; height:"+this.options.iconSize.y+"px;")+'">'+e+t+n+"</svg>"}}),s=function(e,t){var a=L.marker([e.coordinates.latitude,e.coordinates.longitude],{icon:new o({fillColor:n(e.category).color})});e.title.translation=ApiFetcher.findTranslation(e.title.translations),e.description.translation=r(ApiFetcher.findTranslation(e.description.translations)).replace(/\n/g,"<br>"),e.location.translation=ApiFetcher.findTranslation(e.location.translations),e.locationHints.translation=ApiFetcher.findTranslation(e.locationHints.translations),t(e,a)},i=function l(e,t,n){var r=arguments.length<=3||arguments[3]===undefined?function(){}:arguments[3],o={id:e.id,after:t};new ApiFetcher(a,o).fetchAll(function(t){t&&(t.component.meetings.edges.forEach(function(t){t.node&&t.node.coordinates&&t.node.coordinates.latitude&&t.node.coordinates.longitude&&(t.node.link=e.url+"/meetings/"+t.node.id,s(t.node,n))}),t.component.meetings.pageInfo.hasNextPage?l(e,t.component.meetings.pageInfo.endCursor,n,r):r())})};e.AwesomeMap=e.AwesomeMap||{},e.AwesomeMap.fetchMeetings=i}(window),function(e){var t=e.AwesomeMap,n=t.layers,r=t.hideControls,a=t.cluster,o=t.control,s=t.addProposalsControls,i=t.addMeetingsControls,l=t.addSearchControls,p=t.addCategoriesControls,c=t.addHashtagsControls,d=t.fetchProposals,u=t.fetchMeetings,m=t.options,f=t.show,g=t.components,h=t.amendments,v=t.allMarkers,w=t.drawMarker,_=t.getCategory,y=e.$;e.AwesomeMap.allMarkersLoaded=y.noop;var b=function(e){m().center?e.setView(m().center,m().zoom):a.getBounds().isValid()&&e.fitBounds(a.getBounds(),{padding:[50,50]})};e.AwesomeMap.loadMapElements=function(t){b(t),o.addTo(t),a.addTo(t),r()&&y(o.getContainer()).hide(),g().forEach(function(r){"proposals"==r.type&&(s(t,r),d(r,"",function(e,a){f()[e.state||"notAnswered"]&&(w(e,a,r).addTo(n.proposals.group),m().menu.hashtags&&c(t,e.hashtags,a))},function(){b(t),v.forEach(function(e){h.find(function(t){return t==e.element.id})&&(e.marker.removeFrom(n.proposals.group),m().menu.amendments&&e.marker.addTo(n.amendments.group))}),e.AwesomeMap.allMarkersLoaded()})),m().menu.meetings&&"meetings"==r.type&&(i(t,r),u(r,"",function(e,t){w(e,t,r).addTo(n.meetings.group)},function(){return b(t)}))}),l(t),p(t),y("#awesome-map").on("change",".awesome_map-categories-selector",function(e){e.preventDefault(),e.stopPropagation();var r=y(e.target).closest("label").data("layer"),a=_(r);if(a){var o=n[a.id];e.target.checked?(t.addLayer(o.group),x(a.parent)):(t.removeLayer(o.group),a.children().forEach(function(e){var t=y(".awesome_map-category-"+e.id);t.parent().prev().prop("checked")&&t.click()})),A()}});var x=function(e){if(y('[class^="awesome_map-category-"]').parent().prev().prop("indeterminate",!1),e){var t=y(".awesome_map-category-"+e).parent().prev();t.prop("checked")||t.prop("indeterminate",!0)}},A=function(){y(".awesome_map-hashtags-selector").each(function(e,r){var a=n[y(r).closest("label").data("layer")];a&&t.removeLayer(a.group)}),y(".awesome_map-hashtags-selector:checked").each(function(e,r){var a=n[y(r).closest("label").data("layer")];a&&t.addLayer(a.group)}),y(".awesome_map-categories-selector:not(:checked)").each(function(e,r){var a=n[y(r).closest("label").data("layer")];a&&(t.addLayer(a.group),t.removeLayer(a.group))})};y("#awesome-map").on("change",".awesome_map-hashtags-selector",function(e){e.preventDefault(),e.stopPropagation(),y(e.target).closest("label").data("layer")&&A()}),y("#awesome-map").on("click",".awesome_map-toggle_all_tags",function(e){e.preventDefault(),e.stopPropagation(),y("#awesome-map .awesome_map-hashtags-selector").prop("checked",y("#awesome-map .awesome_map-hashtags-selector:checked").length<y("#awesome-map .awesome_map-hashtags-selector").length),A()}),y("#awesome-map").on("click",".awesome_map-title-control",function(e){e.preventDefault(),e.stopPropagation(),y("#awesome_map-hashtags-control").toggleClass("active")})},e.AwesomeMap.hashtagAdded=function(e,t){var n=t.contents("label:last");n.prev("label").length&&t.contents("label").each(function(e,t){if(y(t).text().localeCompare(n.text())>0)return y(t).before(n),!1})}}(window);