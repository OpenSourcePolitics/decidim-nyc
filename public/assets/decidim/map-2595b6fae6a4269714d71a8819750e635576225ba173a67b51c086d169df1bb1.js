/*
 * jQuery Templating Plugin
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}!function(e){function t(t,n,r,i){var a={data:i||(n?n.data:{}),_wrap:n?n._wrap:null,tmpl:null,parent:n||null,nodes:[],calls:u,nest:p,wrap:s,html:f,update:d};return t&&e.extend(a,t,{nodes:[],parent:n}),r&&(a.tmpl=r,a._ctnt=a._ctnt||a.tmpl(e,a),a.key=++w,(C.length?_:v)[w]=a),a}function n(t,i,a){var o,l=a?e.map(a,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+g+'="'+t.key+'" $2'):e:n(e,t,e._ctnt)}):t;return i?l:((l=l.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,n,i,a){c(o=e(i).get()),n&&(o=r(n).concat(o)),a&&(o=o.concat(r(a)))}),o||r(l))}function r(t){var n=document.createElement("div");return n.innerHTML=t,e.makeArray(n.childNodes)}function i(t){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,n,r,i,a,l,c){var u,p,s,f=e.tmpl.tag[r];if(!f)throw"Template command not found: "+r;return u=f._default||[],l&&!/\w$/.test(a)&&(a+=l,l=""),a?(a=o(a),c=c?","+o(c)+")":l?")":"",p=l?a.indexOf(".")>-1?a+l:"("+a+").call($item"+c:a,s=l?p:"(typeof("+a+")==='function'?("+a+").call($item):("+a+"))"):s=p=u.$1||"null",i=o(i),"');"+f[n?"close":"open"].split("$notnull_1").join(a?"typeof("+a+")!=='undefined' && ("+a+")!=null":"true").split("$1a").join(s).split("$1").join(p).split("$2").join(i?i.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(e,t,n,r){return(r=r?","+r+")":n?")":"")?"("+t+").call($item"+r:e}):u.$2||"")+"_.push('"})+"');}return _;")}function a(t,r){t._wrap=n(t,!0,e.isArray(r)?r:[y.test(r)?r:e(r).html()]).join("")}function o(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function l(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function c(n){function r(n){function r(e){o=p[e+=u]=p[e]||t(o,v[o.parent.key+u]||o.parent,null,!0)}var i,a,o,l,c=n;if(l=n.getAttribute(g)){for(;c.parentNode&&1===(c=c.parentNode).nodeType&&!(i=c.getAttribute(g)););i!==l&&(c=c.parentNode?11===c.nodeType?0:c.getAttribute(g)||0:0,(o=v[l])||((o=t(o=_[l],v[c]||_[c],null,!0)).key=++w,v[w]=o),b&&r(l)),n.removeAttribute(g)}else b&&(o=e.data(n,"tmplItem"))&&(r(o.key),v[o.key]=o,c=(c=e.data(n.parentNode,"tmplItem"))?c.key:0);if(o){for(a=o;a&&a.key!=c;)a.nodes.push(n),a=a.parent;delete o._ctnt,delete o._wrap,e.data(n,"tmplItem",o)}}var i,a,o,l,c,u="_"+b,p={};for(o=0,l=n.length;o<l;o++)if(1===(i=n[o]).nodeType){for(c=(a=i.getElementsByTagName("*")).length-1;c>=0;c--)r(a[c]);r(i)}}function u(e,t,n,r){if(!e)return C.pop();C.push({_:e,tmpl:t,item:this,data:n,options:r})}function p(t,n,r){return e.tmpl(e.template(t),n,r,this)}function s(t,n){var r=t.options||{};return r.wrapped=n,e.tmpl(e.template(t.tmpl),t.data,r,t.item)}function f(t,n){var r=this._wrap;return e.map(e(e.isArray(r)?r.join(""):r).filter(t||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||l(e)})}function d(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]),e(t).remove()}var m,h=e.fn.domManip,g="_tmplitem",y=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,v={},_={},k={key:0,data:{}},w=0,b=0,C=[];e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,n){e.fn[t]=function(r){var i,a,o,l,c=[],u=e(r),p=1===this.length&&this[0].parentNode;if(m=v||{},p&&11===p.nodeType&&1===p.childNodes.length&&1===u.length)u[n](this[0]),c=this;else{for(a=0,o=u.length;a<o;a++)b=a,i=(a>0?this.clone(!0):this).get(),e.fn[n].apply(e(u[a]),i),c=c.concat(i);b=0,c=this.pushStack(c,t,u.selector)}return l=m,m=null,e.tmpl.complete(l),c}}),e.fn.extend({tmpl:function(t,n,r){return e.tmpl(this[0],t,n,r)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(t,n,r){if(t[0]&&t[0].nodeType){for(var i,a=e.makeArray(arguments),o=t.length,l=0;l<o&&!(i=e.data(t[l++],"tmplItem")););o>1&&(a[0]=[e.makeArray(t)]),i&&b&&(a[2]=function(t){e.tmpl.afterManip(this,t,r)}),h.apply(this,a)}else h.apply(this,arguments);return b=0,m||e.tmpl.complete(v),this}}),e.extend({tmpl:function(r,i,o,l){var c,u=!l;if(u)l=k,r=e.template[r]||e.template(null,r),_={};else if(!r)return r=l.tmpl,v[l.key]=l,l.nodes=[],l.wrapped&&a(l,l.wrapped),e(n(l,null,l.tmpl(e,l)));return r?("function"==typeof i&&(i=i.call(l||{})),o&&o.wrapped&&a(o,o.wrapped),c=e.isArray(i)?e.map(i,function(e){return e?t(o,l,r,e):null}):[t(o,l,r,i)],u?e(n(l,null,c)):c):[]},tmplItem:function(t){var n;for(t instanceof e&&(t=t[0]);t&&1===t.nodeType&&!(n=e.data(t,"tmplItem"))&&(t=t.parentNode););return n||k},template:function(t,n){return n?("string"==typeof n?n=i(n):n instanceof e&&(n=n[0]||{}),n.nodeType&&(n=e.data(n,"tmpl")||e.data(n,"tmpl",i(n.innerHTML))),"string"==typeof t?e.template[t]=n:n):t?"string"!=typeof t?e.template(null,t):e.template[t]||e.template(null,y.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){v={}},afterManip:function(t,n,r){var i=11===n.nodeType?e.makeArray(n.childNodes):1===n.nodeType?[n]:[];r.call(t,n),c(i),b++}})}(jQuery),function(){var e=window.L;e.DivIcon.SVGIcon.DecidimIcon=e.DivIcon.SVGIcon.extend({options:{fillColor:"#ef604d",opacity:0},_createPathDescription:function(){return"M14 1.17a11.685 11.685 0 0 0-11.685 11.685c0 11.25 10.23 20.61 10.665 21a1.5 1.5 0 0 0 2.025 0c0.435-.435 10.665-9.81 10.665-21A11.685 11.685 0 0 0 14 1.17Zm0 17.415A5.085 5.085 0 1 1 19.085 13.5 5.085 5.085 0 0 1 14 18.585Z"},_createCircle:function(){return""},_createSVG:function(){var e=this._createPath(),t=this._createCircle(),n=this._createText();return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="'+(this.options.className+"-svg")+'" style="'+("width:"+this.options.iconSize.x+"px; height:"+this.options.iconSize.y+"px;")+'">'+e+t+n+"</svg>"}})}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e){var t=e.$,n=e.L,r={},i=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getController",value:function(e){return r[e]}},{key:"setController",value:function(e,t){r[e]=t}},{key:"findByMap",value:function(e){return Object.values(r).find(function(t){return t.getMap()===e})}}]),e}(),a=function(){function e(n,r){_classCallCheck(this,e);var a=i.getController(n);a&&a.remove(),this.mapId=n,this.config=t.extend({popupTemplateId:"marker-popup",markerColor:"#ef604d"},r),this.map=null,i.setController(n,this)}return _createClass(e,[{key:"getConfig",value:function(){return this.config}},{key:"getMap",value:function(){return this.map}},{key:"load",value:function(){return this.map=n.map(this.mapId),this.map.scrollWheelZoom.disable(),this.map.on("popupopen",function(e){t(e.popup.getElement()).attr("tabindex",0).focus()}),this.map.on("popupclose",function(e){t(e.popup._source._icon).focus()}),this.map}},{key:"start",value:function(){}},{key:"remove",value:function(){this.map&&(this.map.remove(),this.map=null)}},{key:"createIcon",value:function(){return new n.DivIcon.SVGIcon.DecidimIcon({fillColor:this.config.markerColor,iconSize:n.point(28,36)})}}]),e}();e.Decidim=e.Decidim||{},e.Decidim.MapController=a,e.Decidim.MapControllerRegistry=i}(window);_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var _get=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(l!==undefined){if("value"in l)return l.value;var c=l.get;return c===undefined?undefined:c.call(o)}var u=Object.getPrototypeOf(i);if(null===u)return undefined;e=u,t=a,n=o,r=!0,l=u=undefined}};!function(e){e.Decidim=e.Decidim||{};var t=e.Decidim.MapController,n=function(){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"start",value:function(){this.markerClusters=null,Array.isArray(this.config.markers)&&this.config.markers.length>0?this.addMarkers(this.config.markers):this.map.fitWorld()}},{key:"addMarkers",value:function(e){var t=this;null===this.markerClusters&&(this.markerClusters=L.markerClusterGroup(),this.map.addLayer(this.markerClusters)),$.template(this.config.popupTemplateId,$("#"+this.config.popupTemplateId).html());var n=function(e){$('input[data-type="latitude"]').val(e.lat),$('input[data-type="longitude"]').val(e.lng)},r=new L.LatLngBounds(e.map(function(e){return[e.latitude,e.longitude]}));e.forEach(function(e){var r=L.marker([e.latitude,e.longitude],{icon:t.createIcon(),keyboard:!0,title:e.title,draggable:e.draggable});if(e.draggable)n({lat:e.latitude,lng:e.longitude}),r.on("drag",function(e){n(e.target.getLatLng())});else{var i=document.createElement("div");$.tmpl(t.config.popupTemplateId,e).appendTo(i),r.bindPopup(i,{maxwidth:640,minWidth:500,keepInView:!0,className:"map-info"}).openPopup()}t.markerClusters.addLayer(r)});var i=this.map.getSize();i.y>=400&&i.x>=400?this.map.fitBounds(r,{padding:[100,100]}):i.y>=120&&i.x>=120?this.map.fitBounds(r,{padding:[30,30]}):this.map.fitBounds(r)}},{key:"clearMarkers",value:function(){this.map.removeLayer(this.markerClusters),this.markerClusters=L.markerClusterGroup(),this.map.addLayer(this.markerClusters)}}]),e}();e.Decidim.MapMarkersController=n}(window);_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,a);if(l!==undefined){if("value"in l)return l.value;var c=l.get;return c===undefined?undefined:c.call(o)}var u=Object.getPrototypeOf(i);if(null===u)return undefined;e=u,t=a,n=o,r=!0,l=u=undefined}};!function(e){e.Decidim=e.Decidim||{};var t=e.Decidim.MapController,n=e.open,r=function(){function e(){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return _inherits(e,t),_createClass(e,[{key:"start",value:function(){var e=this;if(this.map.removeControl(this.map.zoomControl),this.map.dragging.disable(),this.map.touchZoom.disable(),this.map.doubleClickZoom.disable(),this.map.scrollWheelZoom.disable(),this.map.boxZoom.disable(),this.map.keyboard.disable(),this.map.tap&&this.map.tap.disable(),this.config.latitude&&this.config.longitude){var t=[this.config.latitude,this.config.longitude];this.map.panTo(t),L.marker(t,{icon:this.createIcon(),keyboard:!0,title:this.config.title}).addTo(this.map)._icon.removeAttribute("tabindex")}this.config.zoom?this.map.setZoom(this.config.zoom):this.map.setZoom(15),this.config.link&&this.map._container.addEventListener("click",function(t){t.preventDefault(),e.map._container.focus(),n(e.config.link,"_blank")})}}]),e}();e.Decidim.MapStaticController=r}(window),function(e){e.Decidim=e.Decidim||{};var t=e.Decidim,n=t.MapMarkersController,r=t.MapStaticController,i=function(e,t){return"static"===t.type?new r(e,t):new n(e,t)};e.Decidim.createMapController=i}(window),function(e){var t=e.$;e.Decidim=e.Decidim||{},t(function(){var n=e.Decidim.createMapController,r=t("[data-decidim-map]");if(r.length<1&&t("#map").length>0)throw new Error("DEPRECATION: Please update your maps customizations or include 'decidim/map/legacy.js' for legacy support!");r.each(function(e,r){var i=t(r),a=i.attr("id");a||(a="map-"+Math.random().toString(36).substr(2,9),i.attr("id",a));var o=i.data("decidim-map"),l=n(a,o),c=l.load();i.data("map",c),i.data("map-controller",l),i.trigger("configure.decidim",[c,o]),l.start(),i.trigger("ready.decidim",[c,o])})})}(window);