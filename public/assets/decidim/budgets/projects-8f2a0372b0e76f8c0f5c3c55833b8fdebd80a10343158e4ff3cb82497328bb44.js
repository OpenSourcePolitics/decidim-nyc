"use strict";$(function(){var t=function(){var t=document.querySelector("[data-progressbox-fixed]"),e=document.querySelector("[data-progress-reference]"),r="is-progressbox-visible";e&&(e.getBoundingClientRect().bottom>0?t.classList.remove(r):t.classList.add(r))};window.addEventListener("scroll",t),window.DecidimBudgets=window.DecidimBudgets||{},window.DecidimBudgets.checkProgressPosition=t}),$(function(){var t,e=$("#projects, #project"),r=$(".budget-summary__total"),n=$("#budget-excess"),a=$(".budget-summary__progressbox"),o=parseInt(r.attr("data-total-allocation"),10),i=function(t){t.stopPropagation(),t.preventDefault()},d=function(t){return t.parents("#loginModal").length>0||t.parents("#authorizationModal").length>0};e.on("click",".budget-list__action",function(t){var e=parseInt(a.attr("data-current-allocation"),10),r=$(t.currentTarget),d=parseInt(r.attr("data-allocation"),10);r.attr("disabled")?i(t):"true"===r.attr("data-add")&&e+d>o&&(n.foundation("toggle"),i(t))}),$("#order-progress [data-toggle=budget-confirm]").length>0&&(t=$(".budget-summary").attr("data-safe-url").split("?")[0],$(document).on("click","a",function(t){d($(t.currentTarget))?window.exitUrl=null:window.exitUrl=t.currentTarget.href}),$(document).on("submit","form",function(t){d($(t.currentTarget))?window.exitUrl=null:window.exitUrl=t.currentTarget.action}),window.addEventListener("beforeunload",function(e){var r=parseInt(a.attr("data-current-allocation"),10),n=window.exitUrl;window.exitUrl=null,0===r||n&&n.startsWith(t)||(e.returnValue=!0)}))});