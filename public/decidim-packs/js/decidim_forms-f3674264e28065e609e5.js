!function(){var e={60545:function(e,t,n){var i={"./decidim/surveys/decidim_surveys.svg":27059};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=r,e.exports=o,o.id=60545},27059:function(e,t,n){"use strict";e.exports=n.p+"media/images/decidim_surveys-5771e3e945ff9473a563.svg"}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/decidim-packs/",function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=function(){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,n),this.wrapperField=t.wrapperField,this.controllerFieldSelector=t.controllerFieldSelector,this.dependentInputSelector=t.dependentInputSelector,this.controllerSelector=this.wrapperField.find(this.controllerFieldSelector),this._bindEvent(),this._run()}var i,o,r;return i=n,(o=[{key:"_run",value:function(){var e=this;this.controllerSelector.each((function(t,n){var i=$(n),o=i.is(":checked");i.parents("div.collection-input").find(e.dependentInputSelector).prop("disabled",!o)}))}},{key:"_bindEvent",value:function(){var e=this;this.controllerSelector.on("change",(function(){e._run()}))}}])&&t(i.prototype,o),r&&t(i,r),Object.defineProperty(i,"prototype",{writable:!1}),n}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.wrapperField=t.wrapperField,this._bindEvent(),this._order(),this._normalize()}var t,n,i;return t=e,(n=[{key:"_order",value:function(){var e=$(this.wrapperField).find(".collection-input").length;$(this.wrapperField).find(".collection-input").each((function(t,n){for(var i=$(n).find("input[name$=\\[position\\]]"),o=i.val()?parseInt(i.val(),10):e,r=$(n).next();r.length>0;){var a=r.find("input[name$=\\[position\\]]");o>(a.val()?parseInt(a.val(),10):e)&&r.insertBefore($(n)),r=r.next()}}))}},{key:"_findLastPosition",value:function(){var e=0;return $(this.wrapperField).find(".collection-input").each((function(t,n){var i=$(n).find("input[name$=\\[position\\]]"),o=parseInt(i.val(),10);o>e&&(e=o)})),e}},{key:"_normalize",value:function(){$(this.wrapperField).find(".collection-input .position").each((function(e,t){var n=$(t).parent().find("input[name$=\\[position\\]]");n.val()&&(n.val(e),n.prop("disabled",!1),$(t).html("".concat(e+1,". ")))}))}},{key:"_bindEvent",value:function(){var e=this;$(this.wrapperField).find("input[type=checkbox]").on("change",(function(t){var n=$(t.target).parents("label"),i=n.find(".position"),o=n.find("input[name$=\\[position\\]]"),r=e._findLastPosition();t.target.checked?(o.val(r+1),o.prop("disabled",!1),i.html(r+1)):(o.val(""),o.prop("disabled",!0),i.html("")),e._order(),e._normalize()}))}}])&&r(t.prototype,n),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),this.wrapperField=t.wrapperField,this.type=t.type,this.conditionQuestion=t.conditionQuestion,this.answerOption=t.answerOption,this.mandatory=t.mandatory,this.value=t.value,this.onFulfilled=t.onFulfilled,this.bindEvent()}return d(e,[{key:"bindEvent",value:function(){this.checkCondition(),this.getInputsToListen().on("change",this.checkCondition.bind(this))}},{key:"getInputValue",value:function(){var e=$(".question[data-question-id='".concat(this.conditionQuestion,"']")),t=e.find("textarea, input[type='text']:not([name$=\\[custom_body\\]])");if(t.length)return t.val();var n=[];return e.find(".radio-button-collection, .check-box-collection").find(".collection-input").each((function(e,t){var i=$(t).find("input[name$=\\[body\\]]");if(i.is(":checked")){var o=$(t).find("input[name$=\\[custom_body\\]]").val(),r=i.val(),a=$(t).find("input[name$=\\[answer_option_id\\]]").val();n.push({id:a,value:r,text:o})}})),n}},{key:"getInputsToListen",value:function(){var e=$(".question[data-question-id='".concat(this.conditionQuestion,"']")),t=e.find("textarea, input[type='text']:not([name$=\\[custom_body\\]])");return t.length?t:e.find(".collection-input").find("input:not([type='hidden'])")}},{key:"checkAnsweredCondition",value:function(e){return"object"!==l(e)?Boolean(e):Boolean(e.some((function(e){return e.value})))}},{key:"checkNotAnsweredCondition",value:function(e){return!this.checkAnsweredCondition(e)}},{key:"checkEqualCondition",value:function(e){var t=this;return!!e.length&&e.some((function(e){return e.id===t.answerOption.toString()}))}},{key:"checkNotEqualCondition",value:function(e){var t=this;return!!e.length&&e.every((function(e){return e.id!==t.answerOption.toString()}))}},{key:"checkMatchCondition",value:function(e){var t=new RegExp(this.value,"i");return"object"!==l(e)?Boolean(e.match(t)):e.some((function(e){return e.text?e.text.match(t):e.value.match(t)}))}},{key:"checkCondition",value:function(){var e=this.getInputValue(),t=!1;switch(this.type){case"answered":t=this.checkAnsweredCondition(e);break;case"not_answered":t=this.checkNotAnsweredCondition(e);break;case"equal":t=this.checkEqualCondition(e);break;case"not_equal":t=this.checkNotEqualCondition(e);break;case"match":t=this.checkMatchCondition(e);break;default:t=!1}this.onFulfilled(t)}}]),e}(),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,e),this.wrapperField=t.wrapperField,this.conditions={},this.showCount=0,this.initializeConditions()}return d(e,[{key:"initializeConditions",value:function(){var e=this;this.wrapperField.find(".display-condition").each((function(t,n){var i=$(n),o=i.data("id");e.conditions[o]={},e.conditions[o]=new s({wrapperField:e.wrapperField,type:i.data("type"),conditionQuestion:i.data("condition"),answerOption:i.data("option"),mandatory:i.data("mandatory"),value:i.data("value"),onFulfilled:function(t){e.onFulfilled(o,t)}})}))}},{key:"mustShow",value:function(){var e=Object.values(this.conditions),t=e.filter((function(e){return e.mandatory})),n=e.filter((function(e){return!e.mandatory}));return t.length?t.every((function(e){return e.fulfilled})):n.some((function(e){return e.fulfilled}))}},{key:"onFulfilled",value:function(e,t){this.conditions[e].fulfilled=t,this.mustShow()?this.showQuestion():this.hideQuestion()}},{key:"showQuestion",value:function(){this.wrapperField.fadeIn(),this.wrapperField.find("input, textarea").prop("disabled",null),this.showCount++}},{key:"hideQuestion",value:function(){this.showCount?this.wrapperField.fadeOut():this.wrapperField.hide(),this.wrapperField.find("input, textarea").prop("disabled","disabled")}}]),e}();function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,e),this.wrapperField=t.wrapperField,this.alertElement=t.alertElement,this.controllerFieldSelector=t.controllerFieldSelector,this.controllerCollectionSelector=t.controllerCollectionSelector,this.maxChoices=t.maxChoices,this.controllerSelector=this.wrapperField.find(this.controllerFieldSelector),this._bindEvent(),this._run()}var t,n,i;return t=e,(n=[{key:"_run",value:function(){var e=this,t=this.wrapperField.find(this.controllerCollectionSelector),n=!1;t.each((function(t,i){var o=$(i).find(e.controllerFieldSelector).filter((function(e,t){return $(t).is(":checked")}));n=n||o.length>e.maxChoices})),n?this.alertElement.show():this.alertElement.hide()}},{key:"_bindEvent",value:function(){var e=this;this.controllerSelector.on("change",(function(){e._run()}))}}])&&f(t.prototype,n),i&&f(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();$((function(){$(".radio-button-collection, .check-box-collection").each((function(e,t){var n;n={wrapperField:$(t),controllerFieldSelector:"input[type=radio], input[type=checkbox]",dependentInputSelector:"input[type=text], input[type=hidden]"},new i(n)})),$.unique($(".check-box-collection").parents(".answer")).each((function(e,t){var n,i=$(t).data("max-choices");i&&(n={wrapperField:$(t),controllerFieldSelector:"input[type=checkbox]",controllerCollectionSelector:".check-box-collection",alertElement:$(t).find(".max-choices-alert"),maxChoices:i},new v(n))})),$(".sortable-check-box-collection").each((function(e,t){var n;n={wrapperField:$(t)},new a(n)})),$(".answer-questionnaire .question[data-conditioned='true']").each((function(e,t){var n;n={wrapperField:$(t)},new p(n)}));var e=$("form.answer-questionnaire");if(e.length>0){e.find("input, textarea, select").on("change",(function(){e.data("changed",!0)}));var t=e.data("safe-path").split("?")[0];$(document).on("click","a",(function(e){window.exitUrl=e.currentTarget.href})),$(document).on("submit","form",(function(e){window.exitUrl=e.currentTarget.action})),window.addEventListener("beforeunload",(function(n){var i=window.exitUrl,o=e.data("changed");window.exitUrl=null,!o||i&&i.includes(t)||(n.returnValue=!0)}))}})),n(60545)}()}();
//# sourceMappingURL=decidim_forms-f3674264e28065e609e5.js.map