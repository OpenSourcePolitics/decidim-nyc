!function(){var t,e={74247:function(){L.TileLayer.HERE=L.TileLayer.extend({options:{subdomains:"1234",minZoom:2,maxZoom:18,scheme:"normal.day",resource:"maptile",mapId:"newest",format:"png8",appId:"",appCode:"",useCIT:!1,useHTTPS:!0,language:"",language2:""},initialize:function(t){var e=(t=L.setOptions(this,t)).scheme.split(".")[0];t.tileResolution=256;var n=["apiKey="+encodeURIComponent(t.apiKey)];t.apiKey||(n=["app_id="+encodeURIComponent(t.appId),"app_code="+encodeURIComponent(t.appCode)]),t.language&&n.push("lg="+encodeURIComponent(t.language)),t.language2&&n.push("lg2="+encodeURIComponent(t.language2));var o="/maptile/2.1/{resource}/{mapId}/{scheme}/{z}/{x}/{y}/{tileResolution}/{format}"+("?"+n.join("&")),i="/maptile/2.1/copyright/{mapId}?apiKey={apiKey}",r="maps.ls.hereapi.com";t.apiKey||(r="maps"+(t.useCIT?".cit":"")+".api.here.com",i="/maptile/2.1/copyright/{mapId}?app_id={appId}&app_code={appCode}");var a="base."+r;"satellite"!=e&&"terrain"!=e&&"hybrid"!=e||(a="aerial."+r),-1!==t.scheme.indexOf(".traffic.")&&(a="traffic"+r);var c="http"+(t.useHTTPS?"s":""),s=c+"://{s}."+a+o;this._attributionUrl=L.Util.template(c+"://1."+a+i,this.options),L.TileLayer.prototype.initialize.call(this,s,t),this._attributionText=""},onAdd:function(t){L.TileLayer.prototype.onAdd.call(this,t),this._attributionBBoxes||this._fetchAttributionBBoxes()},onRemove:function(t){this._map.attributionControl.removeAttribution(this._attributionText),this._attributionText="",this._map.off("moveend zoomend resetview",this._findCopyrightBBox,this),L.TileLayer.prototype.onRemove.call(this,t)},_fetchAttributionBBoxes:function(){var t=new XMLHttpRequest;t.onreadystatechange=L.bind((function(){4==t.readyState&&200==t.status&&this._parseAttributionBBoxes(JSON.parse(t.responseText))}),this),t.open("GET",this._attributionUrl,!0),t.send()},_parseAttributionBBoxes:function(t){if(this._map){for(var e=t[this.options.scheme.split(".")[0]]||t.normal,n=0;n<e.length;n++)if(e[n].boxes)for(var o=0;o<e[n].boxes.length;o++){var i=e[n].boxes[o];e[n].boxes[o]=L.latLngBounds([[i[0],i[1]],[i[2],i[3]]])}this._map.on("moveend zoomend resetview",this._findCopyrightBBox,this),this._attributionProviders=e,this._findCopyrightBBox()}},_findCopyrightBBox:function(){if(this._map){for(var t=this._attributionProviders,e=[],n=this._map.getZoom(),o=this._map.getBounds(),i=0;i<t.length;i++)if(t[i].minLevel<=n&&t[i].maxLevel>=n)if(t[i].boxes)for(var r=0;r<t[i].boxes.length;r++){var a=t[i].boxes[r];if(o.intersects(a)){e.push(t[i]);break}}else e.push(t[i]);var c=['<a href="https://legal.here.com/en-gb/terms" target="_blank" rel="noopener noreferrer">HERE maps</a>'];for(i=0;i<e.length;i++){var s=e[i];c.push('<abbr title="'+s.alt+'">'+s.label+"</abbr>")}var l="\xa9 "+c.join(", ")+". ";l!==this._attributionText&&(this._map.attributionControl.removeAttribution(this._attributionText),this._map.attributionControl.addAttribution(this._attributionText=l))}}}),L.tileLayer.here=function(t){return new L.TileLayer.HERE(t)}},18662:function(t,e,n){"use strict";n(41751);var o=n(45243),i=(n(6635),n(48782)),r=(n(95732),n(53462),n(24472));n(74247);o.DivIcon.SVGIcon=i.q,o.DivIcon.SVGIcon.DecidimIcon=o.DivIcon.SVGIcon.extend({options:{fillColor:"#ef604d",opacity:0},_createPathDescription:function(){return"M14 1.17a11.685 11.685 0 0 0-11.685 11.685c0 11.25 10.23 20.61 10.665 21a1.5 1.5 0 0 0 2.025 0c0.435-.435 10.665-9.81 10.665-21A11.685 11.685 0 0 0 14 1.17Zm0 17.415A5.085 5.085 0 1 1 19.085 13.5 5.085 5.085 0 0 1 14 18.585Z"},_createCircle:function(){return""},_createSVG:function(){var t=this._createPath(),e=this._createCircle(),n=this._createText(),o="".concat(this.options.className,"-svg"),i="width:".concat(this.options.iconSize.x,"px; height:").concat(this.options.iconSize.y,"px;");return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="'.concat(o,'" style="').concat(i,'">').concat(t).concat(e).concat(n,"</svg>")}});n(54183),n(37544);o.DivIcon.SVGIcon.DecidimIcon=o.DivIcon.SVGIcon.extend({options:{iconSize:o.point(24,34),fillColor:getComputedStyle(document.documentElement).getPropertyValue("--primary"),fillOpacity:1,opacity:0},_createPathDescription:function(){return"M12,0.17 C5.5465527,0.17 0.315,5.4015527 0.315,11.855 C0.315,23.105 10.545,32.465 10.98,32.855 C11.5531636,33.3793645 12.4318364,33.3793645 13.005,32.855 C13.44,32.42 23.67,23.045 23.67,11.855 C23.67,5.40740603 18.4475887,0.178276757 12,0.17 Z M12,17.585 C9.19163205,17.585 6.915,15.308368 6.915,12.5 C6.915,9.69163205 9.19163205,7.415 12,7.415 C14.808368,7.415 17.085,9.69163205 17.085,12.5 C17.085,15.308368 14.808368,17.585 12,17.585 L12,17.585 Z"},_createCircle:function(){return""}}),window,$(document).ready((function(){var t=$("#interactive_map").data("here-api-key"),e=$("#interactive_map").data("geojson-data"),n=$("#view-participatory-process"),i=0,a=!1,c="#8a8a8a",s=28,l=o.map("interactive_map",{scrollWheelZoom:!1});r.default.defs("EPSG:3943","+proj=lcc +lat_1=42.25 +lat_2=43.75 +lat_0=43 +lon_0=3 +x_0=1700000 +y_0=2200000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");var u=l.getZoom(),p=o.featureGroup(),d=[],h={};function f(t){return{"font-size":"".concat(t/2-2,"px"),width:"".concat(t-2,"px"),height:"".concat(t-2,"px"),"line-height":"".concat(t-2,"px"),"border-radius":"".concat(t/2,"px")}}function m(t){return void 0!==t.location&&(e=t.location,n=2,Array.isArray(e)&&e.length===n&&!!e.reduce((function(t,e){return t&&null!==t})));var e,n}function v(t,e,n){if(void 0!==t.origin){var i=l.project(o.latLng(t.origin),n),r=e/2.5+t.getRadius()/1.75,a=o.point(i.x+r*Math.cos(Math.PI/4),i.y-r*Math.sin(Math.PI/4));t._latlng=l.unproject(a,n)}}function g(){return 2*(Math.round(1.75*l.getZoom())+2)}o.tileLayer.here({apiKey:t,scheme:"normal.day.grey"},{continuousWorld:!0}).addTo(l),l.createPane("processPane").style.zIndex=610;var y=o.markerClusterGroup({clusterPane:"processPane",zoomToBoundsOnClick:!1,removeOutsideVisibleBounds:!0,spiderfyDistanceMultiplier:2,chunkedLoading:!0,showCoverageOnHover:!1,maxClusterRadius:40,spiderLegPolylineOptions:{weight:2,color:getComputedStyle(document.documentElement).getPropertyValue("--primary"),opacity:1},iconCreateFunction:function(t){var e,n=l.getZoom()>u?g():s,i=Object.entries((e=n,{"font-size":"".concat(Math.round(e/3),"px"),width:"".concat(e/2,"px"),height:"".concat(e/2,"px"),"line-height":"".concat(e/2,"px"),"border-radius":"".concat(e/4,"px")})).map((function(t){return"".concat(t[0],": ").concat(t[1],";")})).join(" ");return new o.DivIcon({html:'<div style="'+i+'">'+t.getChildCount()+"</div>",className:"marker-cluster",iconSize:new o.Point(n/2,n/2)})}});o.Proj.geoJson(e,{style:function(t){return{interactive:!1,stroke:!0,color:c,weight:1.5,fillColor:t.color,fillOpacity:.5}}}).eachLayer((function(t){var e=t.feature,r=o.featureGroup();r.addLayer(t),r.on("mouseover",(function(){this.setStyle({fillOpacity:.8})})),r.on("mouseout",(function(){this.setStyle({fillOpacity:.5})}));var c=o.divIcon({className:"district-number",html:e.code,iconSize:new o.Point(s,s)}),u=o.PolylabelCentroid(o.GeoJSON.latLngsToCoords(t._latlngs[0],1),.001),f=o.marker(u,{icon:c});d.push(f),r.addLayer(f),f.on("keypress",(function(t){if("Enter"===t.originalEvent.key)return window.location=e.link})),f.on("click",(function(t){i=setTimeout((function(){if(!a)return window.location=e.link;a=!1}),500)})),f.on("dblclick",(function(t){clearTimeout(i),a=!0,l.fitBounds(r.getBounds(),{padding:[25,25]})})),e.participatory_processes.forEach((function(e){if(Object.keys(h).includes(e.id.toString())){if(h[e.id.toString()].push(t),m(e))return}else h[e.id.toString()]=[t];var i,r,a=new o.circleMarker(m(e)?e.location:u,{pane:"processPane",radius:Math.round(7),weight:0,fillOpacity:1,fillColor:getComputedStyle(document.documentElement).getPropertyValue("--primary")}),c=document.createElement("div");$(c).html((i=e,r=n.val(),'\n            <div class="map-info__content homepage_interactive_map">\n              <h3>'.concat(i.title,'</h3>\n              <div id="bodyContent">\n                <div class="card__datetime">\n                  <div class="card__datetime__date">\n                    ').concat(i.start_date," - ").concat(i.end_date,'\n                  </div>\n                </div>\n                <div class="map-info__button">\n                  <a href="').concat(i.link,'" class="button button--sc">\n                    ').concat(r,"\n                  </a>\n                </div>\n              </div>\n            </div>\n      "))),a.bindPopup(c,{maxwidth:$(window).width()<600?260:640,minWidth:$(window).width()<600?204:500,keepInView:!0,className:"interactive-map-info"}).openPopup(),a.participatory_process_data=e,a.origin=u,y.addLayer(a)})),p.addLayer(r)})),p.addTo(l),l.fitBounds(p.getBounds(),{padding:[25,25]}),u=l.getZoom(),y.eachLayer((function(t){h[t.participatory_process_data.id.toString()].forEach((function(e){t.on("mouseover",(function(){e.bringToFront().setStyle({fillOpacity:.8,color:getComputedStyle(document.documentElement).getPropertyValue("--primary"),weight:2})})),t.on("mouseout",(function(){e.bringToBack().setStyle({fillOpacity:.5,color:c,weight:1.5})}))})),m(t.participatory_process_data)||v(t,s,l.getZoom())})),l.on("zoomstart",(function(t){$("#interactive_map .leaflet-process-pane").hide()})),l.on("zoomend",(function(t){var e=s;l.getZoom()>u?(e=g(),$("#interactive_map .district-number").css(f(e))):$("#interactive_map .district-number").css(f(s)),d.forEach((function(t){var n=t.options.icon;n.options.iconSize=new o.Point(e,e),t.setIcon(n)})),y.eachLayer((function(t){m(t.participatory_process_data)||v(t,e,l.getZoom())})),y.refreshClusters(),$("#interactive_map .leaflet-process-pane").show()})),y.addTo(l)}));n(4069)},4069:function(){$(document).ready((function(){var t=$("#scope_geolocalized"),e=$("#geojson");function n(t,e){t.is(":checked")?e.show():e.hide()}t.on("click",(function(){n(t,e)})),n(t,e)}))},53462:function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if(t(this,n),this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}var i,r,a;return i=n,(r=[{key:"push",value:function(t){this.data.push(t),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(t){for(var e=this.data,n=this.compare,o=e[t];t>0;){var i=t-1>>1,r=e[i];if(n(o,r)>=0)break;e[t]=r,t=i}e[t]=o}},{key:"_down",value:function(t){for(var e=this.data,n=this.compare,o=this.length>>1,i=e[t];t<o;){var r=1+(t<<1),a=e[r],c=r+1;if(c<this.length&&n(e[c],a)<0&&(r=c,a=e[c]),n(a,i)>=0)break;e[t]=a,t=r}e[t]=i}}])&&e(i.prototype,r),a&&e(i,a),Object.defineProperty(i,"prototype",{writable:!1}),n}();function o(t,e){return t<e?-1:t>e?1:0}function i(t,e,o){var i,c,s,l;e=e||1;for(var u=0;u<t[0].length;u++){var p=t[0][u];(!u||p[0]<i)&&(i=p[0]),(!u||p[1]<c)&&(c=p[1]),(!u||p[0]>s)&&(s=p[0]),(!u||p[1]>l)&&(l=p[1])}var d=s-i,h=l-c,f=Math.min(d,h),m=f/2;if(0===f)return[i,c];for(var v=new n(void 0,r),g=i;g<s;g+=f)for(var y=c;y<l;y+=f)v.push(new a(g+m,y+m,m,t));var _=function(t){for(var e=0,n=0,o=0,i=t[0],r=0,c=i.length,s=c-1;r<c;s=r++){var l=i[r],u=i[s],p=l[0]*u[1]-u[0]*l[1];n+=(l[0]+u[0])*p,o+=(l[1]+u[1])*p,e+=3*p}return 0===e?new a(i[0][0],i[0][1],0,t):new a(n/e,o/e,0,t)}(t),b=new a(i+d/2,c+h/2,0,t);b.d>_.d&&(_=b);for(var x=v.length;v.length;){var w=v.pop();w.d>_.d&&(_=w,o&&console.log("found best %d after %d probes",Math.round(1e4*w.d)/1e4,x)),w.max-_.d<=e||(m=w.h/2,v.push(new a(w.x-m,w.y-m,m,t)),v.push(new a(w.x+m,w.y-m,m,t)),v.push(new a(w.x-m,w.y+m,m,t)),v.push(new a(w.x+m,w.y+m,m,t)),x+=4)}return o&&(console.log("num probes: "+x),console.log("best distance: "+_.d)),[_.x,_.y]}function r(t,e){return e.max-t.max}function a(t,e,n,o){this.x=t,this.y=e,this.h=n,this.d=function(t,e,n){for(var o=!1,i=1/0,r=0;r<n.length;r++)for(var a=n[r],s=0,l=a.length,u=l-1;s<l;u=s++){var p=a[s],d=a[u];p[1]>e!==d[1]>e&&t<(d[0]-p[0])*(e-p[1])/(d[1]-p[1])+p[0]&&(o=!o),i=Math.min(i,c(t,e,p,d))}return(o?1:-1)*Math.sqrt(i)}(t,e,o),this.max=this.d+this.h*Math.SQRT2}function c(t,e,n,o){var i=n[0],r=n[1],a=o[0]-i,c=o[1]-r;if(0!==a||0!==c){var s=((t-i)*a+(e-r)*c)/(a*a+c*c);s>1?(i=o[0],r=o[1]):s>0&&(i+=a*s,r+=c*s)}return(a=t-i)*a+(c=e-r)*c}L.PolylabelCentroid=function(t,e,n){return i(t,e,n).reverse()}},37544:function(){!function(t){var e=/(\s*\S+|\s)$/,n=/^(\S*)/;t.truncate=function(e,n){return t("<div></div>").append(e).truncate(n).html()},t.fn.truncate=function(o){t.isNumeric(o)&&(o={length:o});var i=t.extend({},t.truncate.defaults,o);return this.each((function(){var o=t(this);i.noBreaks&&o.find("br").replaceWith(" ");var r=o.text(),a=r.length-i.length;if(i.stripTags&&o.text(r),i.words&&a>0){var c=r.slice(0,i.length).replace(e,"").length;a=i.keepFirstWord&&0===c?r.length-n.exec(r)[0].length-1:r.length-c-1}a<0||!a&&!i.truncated||t.each(o.contents().get().reverse(),(function(e,n){var o=t(n),r=o.text().length;return r<=a?(i.truncated=!0,a-=r,void o.remove()):3===n.nodeType?(i.finishBlock?t(n.splitText(r)).replaceWith(i.ellipsis):t(n.splitText(r-a-1)).replaceWith(i.ellipsis),!1):(o.truncate(t.extend(i,{length:r-a})),!1)}))}))},t.truncate.defaults={stripTags:!1,words:!1,keepFirstWord:!1,noBreaks:!1,finishBlock:!1,length:1/0,ellipsis:"\u2026"}}(jQuery)}},n={};function o(t){var i=n[t];if(void 0!==i)return i.exports;var r=n[t]={exports:{}};return e[t].call(r.exports,r,r.exports,o),r.exports}o.m=e,t=[],o.O=function(e,n,i,r){if(!n){var a=1/0;for(u=0;u<t.length;u++){n=t[u][0],i=t[u][1],r=t[u][2];for(var c=!0,s=0;s<n.length;s++)(!1&r||a>=r)&&Object.keys(o.O).every((function(t){return o.O[t](n[s])}))?n.splice(s--,1):(c=!1,r<a&&(a=r));if(c){t.splice(u--,1);var l=i();void 0!==l&&(e=l)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[n,i,r]},o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t={8466:0};o.O.j=function(e){return 0===t[e]};var e=function(e,n){var i,r,a=n[0],c=n[1],s=n[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(i in c)o.o(c,i)&&(o.m[i]=c[i]);if(s)var u=s(o)}for(e&&e(n);l<a.length;l++)r=a[l],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(u)},n=self.webpackChunkapp=self.webpackChunkapp||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var i=o.O(void 0,[7337,3113],(function(){return o(18662)}));i=o.O(i)}();
//# sourceMappingURL=decidim_homepage_interactive_map-c2890840268a0f2b091e.js.map